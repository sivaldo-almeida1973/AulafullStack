/*May 18, 2023, 6:29 pm*/function checkInit(){var e;e=!1;try{e=!(window.location.search.indexOf("vt_stop=true")>=0),e=!(document.cookie.indexOf("vt_stop")>=0)&&e,e=!window.vt_stop&&e,window.ignore_vt_stop&&(e=!0),_vtsdk.state.running=e}catch(t){e=!1}window.top!==window.self&&(e=!1);try{if(window.location.search.indexOf("vt_validate=true")>=0){var t=_vtsdk.Helpers.getURLParams(window.location.search),n=_vtsdk.Helpers.addQueryString(_vtsdk.defaults.validateUrl,t);_vtsdk.Helpers.getAsync(n),e=!1}}catch(e){}if(_vtsdk&&!0===_vtsdk.state.ready){e=!1;try{console.log("VTSDK ready.")}catch(e){}}if(e){for(var a=3,o=document.createElement("div"),s=o.getElementsByTagName("i");o.innerHTML="\x3c!--[if gt IE "+ ++a+"]><i></i><![endif]--\x3e",s[0];);if(a<=4){var i=navigator.userAgent.match(/(?:MSIE |Trident\/.*; rv:|Edge\/)(\d+)/);a=i?parseInt(i[1]):-1}e=a>=9||-1==a}e&&_vtsdk.init()}if("object"!=typeof vtstore)var vtstore={};!function(e,t){e.vtstore=function(){var e,t={},n=window,a=n.document,o="localStorage",s="script";if(t.disabled=!1,t.version="1.3.17",t.set=function(e,t){},t.get=function(e,t){},t.has=function(e){return void 0!==t.get(e)},t.remove=function(e){},t.clear=function(){},t.transact=function(e,n,a){null==a&&(a=n,n=null),null==n&&(n={});var o=t.get(e,n);a(o),t.set(e,o)},t.getAll=function(){},t.forEach=function(){},t.serialize=function(e){return JSON.stringify(e)},t.deserialize=function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e||void 0}},function(){try{return o in n&&n[o]}catch(e){return!1}}())e=n[o],t.set=function(n,a){return void 0===a?t.remove(n):(e.setItem(n,t.serialize(a)),a)},t.get=function(n,a){var o=t.deserialize(e.getItem(n));return void 0===o?a:o},t.remove=function(t){e.removeItem(t)},t.clear=function(){e.clear()},t.getAll=function(){var e={};return t.forEach(function(t,n){e[t]=n}),e},t.forEach=function(n){for(var a=0;a<e.length;a++){var o=e.key(a);n(o,t.get(o))}};else if(a.documentElement.addBehavior){var i,r;try{r=new ActiveXObject("htmlfile"),r.open(),r.write("<"+s+">document.w=window</"+s+'><iframe src="/favicon.ico"></iframe>'),r.close(),i=r.w.frames[0].document,e=i.createElement("div")}catch(t){e=a.createElement("div"),i=a.body}var c=function(n){return function(){var a=Array.prototype.slice.call(arguments,0);a.unshift(e),i.appendChild(e),e.addBehavior("#default#userData"),e.load(o);var s=n.apply(t,a);return i.removeChild(e),s}},l=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g"),d=function(e){return e.replace(/^d/,"___$&").replace(l,"___")};t.set=c(function(e,n,a){return n=d(n),void 0===a?t.remove(n):(e.setAttribute(n,t.serialize(a)),e.save(o),a)}),t.get=c(function(e,n,a){n=d(n);var o=t.deserialize(e.getAttribute(n));return void 0===o?a:o}),t.remove=c(function(e,t){t=d(t),e.removeAttribute(t),e.save(o)}),t.clear=c(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(o);for(var n=t.length-1;n>=0;n--)e.removeAttribute(t[n].name);e.save(o)}),t.getAll=function(e){var n={};return t.forEach(function(e,t){n[e]=t}),n},t.forEach=c(function(e,n){for(var a,o=e.XMLDocument.documentElement.attributes,s=0;a=o[s];++s)n(a.name,t.deserialize(e.getAttribute(a.name)))})}try{var p="__storejs__";t.set(p,p),t.get(p)!=p&&(t.disabled=!0),t.remove(p)}catch(e){t.disabled=!0}return t.enabled=!t.disabled,vtstore=t}()}(this),function(e,t){e.vtlodash=function(){function e(e,t){var n={};if(n.bindFunction=function(e,t){return function(){try{return e.apply(t,[t])}catch(e){}}},n.stateChange=function(e){try{4==n.request.readyState&&n.callbackFunction(n.request.responseText)}catch(e){}},n.getRequest=function(){try{return window.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):!!window.XMLHttpRequest&&new XMLHttpRequest}catch(e){}},n.postBody=arguments[2]||"",n.callbackFunction=t,n.url=e,n.request=n.getRequest(),n.request)try{var a=n.request;a.onreadystatechange=n.bindFunction(n.stateChange,n),""!==n.postBody?(a.open("POST",e,!0),a.setRequestHeader("X-Requested-With","XMLHttpRequest"),a.setRequestHeader("Content-type","application/x-www-form-urlencoded")):a.open("GET",e,!0),a.send(n.postBody)}catch(e){}}var t=function(e){return m("Object",e)&&m("Array",e)&&m("String",e)&&!a(e.splice)?!Object.keys(e).length:!o(e)},n=function(e){return void 0===e},a=function(e){var t={};return e&&"[object Function]"===t.toString.call(e)},o=function(e){if(null==e)return 0;try{return m("Array",e)?e.length:Object.keys(e).length}catch(e){return 0}},s=function(e){return null===e},i=function(e){return m("Object",e)},r=function(e){return m("Array",e)},c=function(e){return m("Boolean",e)},l=function(e){return m("Number",e)},d=function(e){return m("String",e)},p=function(e){return m("Arguments",e)},m=function(e,t){var n=Object.prototype.toString.call(t).slice(8,-1);return void 0!==t&&null!==t&&n===e},u=function(e){return[].slice.call(arguments,1).forEach(function(t){var n;for(n in t)n in e&&m("Array",e[n])?e[n]=e[n].concat(t[n]):n in e&&m("Object",e[n])?e[n]=u(e[n],t[n]):e[n]=t[n]}),e},b=function(e,t){for(var a in e)e.hasOwnProperty(a)&&!n(t[a])&&(m("Object",e[a])&&m("Object",t[a])?e[a]=b(e[a],t[a]):e[a]=t[a]);return e};return{isObject:i,isArray:r,merge:u,overwrite:b,size:o,isNull:s,isNumber:l,isBoolean:c,isString:d,isFunction:a,isUndefined:n,isArguments:p,isEmpty:t,request:e}}()}(this),window._vtsdk&&!window.ignore_vt_stop||(window._vtsdk=function(){var documentAlias=document,windowAlias=window,object={v:"19.2.0",defaults:{tags:{prefix:"**|",suffix:"|**"},cdns:[4],cookieNames:{all:"all",ne:"ne",push:"pushtkn",ts:"ts",shop:"shop",sess:"sess",uId:"user",webid:"webid",debug:"debug",stopevents:"stopevents",campaignsStatus:"cs",condCount:"count",visitor:"info",capping:"cap_",poll:"poll",contentStep:"cstep_",cStatus:"c_"},debug:"info",queueCheckInterval:500,visitorHost:"https://pro.ip-api.com/json/?key=aUoasJP8dMuydUf",visitorCallback:"_vtsdk.tasks.callbackVisitor",eventHost:"https://app2.cybba.solutions/event/",eventCallback:"_vtsdk.eventApi.callbackEvent",reccsHost:"https://rec.cybba.solutions/html/",reccsCallbackContent:"_vtsdk.Recommender.callBackRecommenderContent",reccsCallbackTwo:"_vtsdk.Recommender.callBackRecommenderTwo",userHost:"https://app2.cybba.solutions/user",userCallback:"_vtsdk.User.callbackUser",backendHost:"https://rec.cybba.solutions/check/",backendCallback:"_vtsdk.Campaign.triggerCampaigns",mcUrl:"https://pages.cybba.solutions/integrations/mailchimp.php",validateUrl:"https://pages.cybba.solutions/tasks/util/jsValidation.php",prefix:"_vt_",monthDuration:2592e6,dayDuration:864e5,shortDuration:36e6,sessionDuration:432e5,expiration:31536e6,nowTime:(new Date).getTime(),nowTimeLocal:(new Date).getTime(),userIndentityParams:["vt_user","email"],userKeyLength:16,loaderGif:"https://files1.cybba.solutions/_assets/images/ajax-loader.gif",stylesheet:"https://files1.cybba.solutions/_assets/vtmarketing.css",idPrefix:"vt-campaign-",push:{widget:"101",token:"https://admin.cybba.solutions/push/token.php"},recc:{className:"vt-campaign",attributeId:"data-vt-id",cIdLength:7},siteEvents:{click:"siteclick",submit:"sitesubmit",display:"sitedisplay",close:"siteclose",referer:"referer"},siteClasses:{close:"vtw-close",click:"vtw-click",overlay:"vtw-bck",toggle:"vtw-toggle",error:"vtw-error",attr:"vtw-attr",attrPrefix:"vta-",classPrefix:"vtw-",submit:"vtw-submit",required:"vtw-required",invalid:"vtw-invalid"}},state:{timeDiff:0,hasLoaded:!1,waitUserRequest:!1,ready:!1,hasUser:!1,pageQueue:[],reccCampaigns:[],calledRecommender:!1,emailToPush:!1,reccTpls:{},campaignsOK:[],pageCampaigns:{},inactivityCampaigns:[]}};return object.defaults.userIndentityParams.push("utm_ra"),object.shop={id:2464,url:"https://uninter.com",params:{getVisitorInfo:!0,emailGrab:!0,customJS:"/**********************START USER INPUT**************************************/\nwindow.cybData = {};\n\n// Initialization function - allows for customization of basic settings \nwindow.configSettingsCYB = function() {\n        // Various Settings\n        cybData.allowLogs = true; //True to enable debug logs, does not turn off console.log - this will be on by default in staging\n        cybData.cookieStaging = false; //Initalizes cookie staging mode if true and panel will only fire with the cookie - MUST BE FALSE WHEN LIVE (cybbatest=true)\n        cybData.pageView = true;\n\n        //Trigger Rules for ONSITE\n        cybData.exitIntent = true;\n        cybData.onClose = false; // true/false\n        cybData.deskInactivity = 0; //time in seconds\n        cybData.mobileInactivity = 0; //time in seconds\n        cybData.mobileExit = false; // true/false - Firings on buttons from browser/OS\n        cybData.ABtest = [50, 50]; //Percentage of Firing per agent - sets Cookie \"CYB_AB\" with the index of the agent to be fired\n        cybData.sessionMgmt = {\n            timesPerSession: 1, // Times the Onsite can fire per session without the cookie dropping\n            hours: 2 // Time in hours when the onsite can next fire. \n        };\n        cybData.triggerSensitivity = 0.75; // delay for mouse to be outside of browser to delay firing panel \n        cybData.fireTowardsX = [false, 25, 75]; // True if only firing panel when users goes towards the corners of the browser, % for left hand side, % for right hand side\n        cybData.pageForms = []; //add selectors to the array for any forms or elements that should not trigger onsite\n        cybData.addCSS = ''; //add minified CSS for custom CSS here\n        cybData.copiedText = ''; // Text for Copy Success Message, Default is \"COPIED!\" if left blank \n        cybData.SMS = {\n            enabled: false,\n            campaigns: {\n                'EMAILTEMPLATEID': \"TEMPLATEID\"\n            }\n        }\n\n        cybData.onsiteCountDown = { //if enabled and onsite has id='onsiteCountDown' (case insensitive)\n            enabled: false,\n            time: 'Jan 1, 2019 00:00:00', // must be date, number (getTime()), or date string\n            closeOnExpiration: false, // Close onsite after time expiration\n            expiredText: \"EXPIRED\",\n            padNums: true, // shows 09 instead of 9\n            hideZeroes: false, // does not show 0m 30s, instead shows 30s\n            /* ADD THIS HTML TO ONSITE FOR IT TO WORK PROPERLY\n            <div class=\"countdown-timer\" id=\"onsiteCountDown\" style=\"display:inline\"> \n                <span class=\"cDays\"></span><span> d : </span>\n                <span class=\"cHours\" style=></span><span> h : </span>\n                <span class=\"cMins\"></span><span> m : </span>\n                <span class=\"cSecs\"></span><span> s</span>\n             </div>*/\n        }\n\n        /** START PROMOBAR DATA **/\n        cybData.promoBarData = {\n                'IDHERE': { // One object per promobar\n                    enabled: false, //True for live, false for off\n                    position: 'top',\n                    countDown: { //if enabled and onsite has id='cybCountDown' (case insensitive)\n                        countDownDate: 'Jan 1, 2019 00:00:00', // must be date, number (getTime()), or date string\n                        countDownExpirationClose: false, // Close promobar after time expiration\n                        countDownExpireText: \"EXPIRED\",\n                        hasLetters: true, // eg. 4d 6h 2m 10s vs 4:6:2:10\n                        padNums: true, // shows 09 instead of 9\n                        hideZeroes: false, // does not show 0m 30s, instead shows 30s,\n                        syncTime: false // Have time synchronized to initial fire\n                    },\n                    triggers: {\n                        onload: {\n                            enabled: false,\n                            conditionally: true //false will fire the same one every load, true will check filters first\n                        },\n                        afterOE: { //Fires after an Onsite, on next reload\n                            enabled: false,\n                            checkFilters: true\n                        },\n                        mobile: true,\n                        onOEClose: {\n                            enabled: false,\n                            onsiteId: '', //Fires immediately after X button closed on the onsite\n                            conditionally: false\n                        },\n                        exitIntent: false,\n                        persist: { // promobar persists after initial fire dependent on filters, also works to just filter after CYBSession cookie exists\n                            enabled: false,\n                            conditionally: false //false will fire the same one every load, true will check filters first\n                        },\n                        inactivity: 0\n                    },\n                    sessionMgmt: {\n                        enabled: true,\n                        timesPerSession: 1,\n                        hours: 2\n                    },\n                    stickyNav: {\n                        hasStickyNav: false,\n                        selector: ''\n                    },\n                    customJS: { //add JS to run on load or close of promobar\n                        load: \"\",\n                        close: \"\"\n                    }\n                }\n            }\n            /** END PROMOBAR DATA **/\n\n        //Dynamic Product Data\n        cybData.dynamicProductData = {\n            history: false, // true for history features\n            histObjCYB: { // selectors for product page (history) data - leave blank if not using\n                pName: \"\",\n                pPrice: \"\",\n                pImg: \"\",\n                pUrl: window.location.href\n            },\n            addImageURLPrefix: '', // use if you need to add domain or protocol to URL\n            imageIsSource: true, // true if trying to grab image src, false if image is a background image in the CSS\n            viewButtonText: 'View Item',\n            historyTabText: 'History'\n        };\n\n        // Lowers Z-Index of any element that is in-front of the onsite\n        cybData.resetZIndex = {\n            enabled: false,\n            selectors: ['']\n        };\n\n        // V1 Event Load Function\n        cybData.onsiteOnload = {\n            // for v1 set CAMPAIGNID to all to load for all creatives\n            'CAMPAIGNID': 'JS HERE' //Put in Campaign ID or all here to run JS on campaign display\n        };\n\n        /** V2 Event Functions\n        cybData.eventFunctions = {\n             onsiteOnload: {\n                 // set CAMPAIGNID to all to load for all creatives\n                 'CAMPAIGNID' : 'JS HERE' //Put in Campaign ID or 'all' here to run JS on campaign display\n             },\n             onsiteOnClose: {\n                 // set CAMPAIGNID to all to load for all creatives\n                 'CAMPAIGNID' : 'JS HERE' //Put in Campaign ID or 'all' here to run JS on campaign close\n             },\n             onsiteOnClick:{\n                 // set CAMPAIGNID to all to load for all creatives\n                 'CAMPAIGNID' : 'JS HERE' //Put in Campaign ID or 'all' here to run JS on campaign CTA click\n             }\n         }\n         **/\n\n\n\n        cybData.forceCSS = {\n            'SELECTOR': 'CSSHERE'\n        };\n\n        cybData.promptConfig = {\n            attribution: true,\n            applySessionMgmt: true\n        }\n\n        //Do not remove or modify this call, \n        try { setTimeout(initCYB, 500) } catch (e) { console.log(e); }\n    }\n    //Code all things you need to have excute on load here\nwindow.onloadFunctionsCYB = function() {}\n\n// Criteria Filters Here\nwindow.cybbaFilters = function() {\n    let staging = !!~document.cookie.indexOf('cybbatest');\n    let _jan31 = new Date() < new Date(Date.UTC(2023, 0, 31, 04, 59, 00));\n\n    if (!~window.location.href.indexOf('Confirmacao')) {\n        if (!!~window.location.href.indexOf('fichadeinscricao.uninter.com/Inscricoes/ETAPA-1') ||\n            !!~window.location.href.indexOf('fichadeinscricao.uninter.com/Inscricoes/ETAPA-2') ||\n            !!~window.location.href.indexOf('fichadeinscricao.uninter.com/Inscricoes/ETAPA-3') ||\n            !!~window.location.href.indexOf('fichadeinscricao.uninter.com/Inscricoes/ETAPA-4')\n        ) {\n            if (!staging && new Date() < new Date(\"May 22 2023 23:59:59 EST\")) {\n                fireCampaignCYB('1030049');\n            }\n        }\n    }\n\n}\n\n// Promobar Criteria Filters Here\nwindow.promobarFilters = function() {}\n\n/******DO NOT REMOVE********/\nsetTimeout(configSettingsCYB, 1000);\n/******DO NOT REMOVE********/",hasActTriggers:!1,hasSendActTriggers:!1,hasRunningInteractions:!0,hasRunningContent:!1,hasRunningAds:!1,countConditions:[],webidTags:[],embedCSS:!0,getVisitorWebid:!1},agency:108,debug:"none",domain:"uninter.com",campaigns:{1028534:{id:1028534,templates:{10031117:'<style>\n  .vtw-close.cybPromptXButton {\n      right: 86px;\n      position: fixed;\n      width: 25px;\n      height: 35px;\n      top: 5px;\n      z-index: 9999999999999;\n      opacity: 0.5;\n      line-height: 200%;\n      background-image: url(\'https://d3u0jcwe5p7qrc.cloudfront.net/Cybba/Onsite/Template/Prompt/images/close-window.png\');\n      background-repeat: no-repeat;\n      background-color: transparent;\n  }\n  \n  \n  /* PROMPT CONTENT STYLES START*/\n  \n  .cybHero {\n      width: 400px;\n  }\n  \n  .cybHeading1 {\n      padding-top: 0%;\n      font-size: 20px !important;\n      color: #ffffff !important;\n      font-family: Arial, sans-serif !important;\n      padding-bottom: 0%;\n      font-weight: 700 !important;\n      text-transform: uppercase !important;\n      line-height: 130%;\n  }\n  \n  .cybHeading2 {\n      padding-top: 0%;\n      font-size: 20px !important;\n      color: #ffffff !important;\n      font-family: Arial, sans-serif !important;\n      padding-bottom: 0%;\n      font-weight: 700 !important;\n      text-transform: uppercase !important;\n      line-height: 130%;\n  }\n  \n  .cybPrompt .cybMainCTA {\n      font-family: Arial, sans-serif !important;\n      padding: 9px 14px !important;\n      text-align: center !important;\n      color: #FFF !important;\n      font-weight: normal !important;\n      display: inline-block !important;\n      font-size: 18px !important;\n      width: 30% !important;\n      border-radius: 0px !important;\n      margin-top: 20px;\n      background-color: #043899 !important;\n      text-decoration: none !important;\n  }\n  \n  \n  /* PROMPT CONTENT STYLES END*/\n  \n  .cybTextcontent {\n      padding: 0px 20px !important;\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      margin-right: -50%;\n      transform: translate(-50%, -50%);\n      font-family: Arial, sans-serif !important;\n      text-align: left !important;\n  }\n  \n  \n  /* BACKGROUND STYLES START*/\n  \n  .cybPromptBkg {\n      height: 100%;\n      overflow: hidden;\n      width: 100%;\n      background-repeat: no-repeat;\n      background-color: transparent;\n      background-position-x: center;\n      background-size: cover;\n  }\n  \n  .cybPrompt {\n      position: fixed;\n      width: 540px;\n      max-width: 735px;\n      height: 375px !important;\n      text-align: center;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      border-radius: 0px !important;\n      z-index: 99999999 !important;\n      display: flex;\n  }\n  \n  \n  /* BACKGROUND STYLES END*/\n  \n  \n  /* MOBILE TEXT STYLE STARTS */\n  \n  @media (max-width:480px) {\n      .vtw-close img {\n          right: 85% !important;\n      }\n      .cybPromptBkg {\n          position: absolute;\n          bottom: 0;\n          background-size: cover;\n      }\n      .cybHeading1 {\n          font-size: 35px !important;\n          line-height: 150% !important;\n          padding: 5% 0;\n      }\n      .cybHeading2 {\n          font-size: 20px !important;\n      }\n      .cybPrompt {\n          position: fixed;\n          width: 80vw !important;\n          max-width: 735px;\n          text-align: center;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          border-radius: 0px !important;\n          z-index: 99999999 !important;\n          display: flex;\n      }\n      .cybTextcontent {\n          text-align: left !important;\n      }\n      .cybPrompt .cybMainCTA {\n          padding: 9px 14px !important;\n          text-align: center !important;\n          width: 40vw !important;\n          top: 65% !important;\n      }\n      .vtw-close.cybPromptXButton {\n          right: 55px;\n          position: fixed;\n          width: 25px;\n          height: 35px;\n          top: calc(100% - 80%) !important;\n          text-decoration: none !important;\n          background-image: url(\'https://d3u0jcwe5p7qrc.cloudfront.net/Cybba/Onsite/Template/Prompt/images/close_mobile.png\');\n          background-repeat: no-repeat;\n      }\n  }\n  \n  \n  /* MOBILE TEXT STYLE ENDS */\n  \n  .cybBackgroundOverlay {\n      background-color: grey;\n      height: 100% !important;\n      width: 100% !important;\n      opacity: 0.5;\n      z-index: 100 !important;\n      position: fixed;\n      top: 0;\n  }\n</style>\n\x3c!--DO NOT REMOVE--\x3e\n<meta name="viewport" content="width=device-width, initial-scale=1">\n\x3c!--DO NOT REMOVE--\x3e\n\x3c!--START Background Overlay--\x3e\n<div class="cybBackgroundOverlay"></div>\n\x3c!--END Background Overlay--\x3e\n<div class="vtw-campaign cybPrompt">\n  \x3c!--START X Button--\x3e<a class="vtw-close cybPromptXButton" href="javascript:void(0)"><span onclick="closeOnsiteCYB()"></span></a>\n  \x3c!--END X Button--\x3e\n  <div class="cybPromptBkg">\n    <div class="cybTextcontent">\n      <a href="javascript:void(0);" class="vtw-click  vtw-close">\n        <div onclick="vtCompleteOrder()"><img class="cybHero" src="https://d3u0jcwe5p7qrc.cloudfront.net/03_LATAM/UninterBR/Onsite/484518/UninterBR_CreativeShowcase_12.20.22/creatives/484518_UninterBR_Onsite_WP_SG1/images/midscreen.jpg"></div>\n      </a>\n    </div>\n  </div>\n</div>'},templatesPick:{params:{10031117:100},strategy:"weighted-random",ranges:[100]},siteParams:{single:!0,embed:!1,eventBound:!1,displayRules:[{key:"vars.cybAllow",val:"yes",op:"eq"}],displayCount:0,displayCountSession:1,afterClose:"1",autoClose:0,afterSubmit:"close",mailchimpList:0,trigger:{mode:"onClick",params:{selector:""}},testMode:!1,priority:0,displayRulesOR:[],backendRules:[],backendRulesOR:[],endDate:!1,end:!1,startDate:!1,start:!1},campaignType:7,teasers:{10031117:"\n\n                    ",10032192:"\n\n                    ",10032436:"\n\n                    ",10032683:"\n\n                    "}},1029576:{id:1029576,templates:{10032192:'<style>\n  .vtw-close.cybPromptXButton {\n      right: 129px;\n      position: fixed;\n      width: 25px;\n      height: 35px;\n      top: 5px;\n      z-index: 9999999999999;\n      opacity: 0.5;\n      line-height: 200%;\n      background-image: url(\'https://d3u0jcwe5p7qrc.cloudfront.net/Cybba/Onsite/Template/Prompt/images/close-window.png\');\n      background-repeat: no-repeat;\n      background-color: transparent;\n  }\n  \n  \n  /* PROMPT CONTENT STYLES START*/\n  \n  .cybHero {\n      width: 80%;\n  }\n  \n  .cybHeading1 {\n      padding-top: 0%;\n      font-size: 20px !important;\n      color: #ffffff !important;\n      font-family: Arial, sans-serif !important;\n      padding-bottom: 0%;\n      font-weight: 700 !important;\n      text-transform: uppercase !important;\n      line-height: 130%;\n  }\n  \n  .cybHeading2 {\n      padding-top: 0%;\n      font-size: 20px !important;\n      color: #ffffff !important;\n      font-family: Arial, sans-serif !important;\n      padding-bottom: 0%;\n      font-weight: 700 !important;\n      text-transform: uppercase !important;\n      line-height: 130%;\n  }\n  \n  .cybPrompt .cybMainCTA {\n      font-family: Arial, sans-serif !important;\n      padding: 9px 14px !important;\n      text-align: center !important;\n      color: #FFF !important;\n      font-weight: normal !important;\n      display: inline-block !important;\n      font-size: 18px !important;\n      width: 30% !important;\n      border-radius: 0px !important;\n      margin-top: 20px;\n      background-color: #043899 !important;\n      text-decoration: none !important;\n  }\n  \n  \n  /* PROMPT CONTENT STYLES END*/\n  \n  .cybTextcontent {\n      padding: 0px 20px !important;\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      margin-right: -50%;\n      transform: translate(-50%, -50%);\n      font-family: Arial, sans-serif !important;\n      text-align: left !important;\n  }\n  \n  \n  /* BACKGROUND STYLES START*/\n  \n  .cybPromptBkg {\n      height: 100%;\n      overflow: hidden;\n      width: 100%;\n      background-repeat: no-repeat;\n      background-color: transparent;\n      background-position-x: center;\n      background-size: cover;\n  }\n  \n  .cybPrompt {\n      position: fixed;\n      width: 540px;\n      max-width: 735px;\n      height: 375px !important;\n      text-align: center;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      border-radius: 0px !important;\n      z-index: 99999999 !important;\n      display: flex;\n  }\n  \n  \n  /* BACKGROUND STYLES END*/\n  \n  \n  /* MOBILE TEXT STYLE STARTS */\n  \n  @media (max-width:480px) {\n      .vtw-close img {\n          right: 85% !important;\n      }\n      .cybPromptBkg {\n          position: absolute;\n          bottom: 0;\n          background-size: cover;\n      }\n      .cybHeading1 {\n          font-size: 35px !important;\n          line-height: 150% !important;\n          padding: 5% 0;\n      }\n      .cybHeading2 {\n          font-size: 20px !important;\n      }\n      .cybPrompt {\n          position: fixed;\n          width: 80vw !important;\n          max-width: 735px;\n          text-align: center;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          border-radius: 0px !important;\n          z-index: 99999999 !important;\n          display: flex;\n      }\n      .cybTextcontent {\n          text-align: left !important;\n      }\n      .cybPrompt .cybMainCTA {\n          padding: 9px 14px !important;\n          text-align: center !important;\n          width: 40vw !important;\n          top: 65% !important;\n      }\n      .vtw-close.cybPromptXButton {\n          right: 55px;\n          position: fixed;\n          width: 25px;\n          height: 35px;\n          top: calc(100% - 80%) !important;\n          text-decoration: none !important;\n          background-image: url(\'https://d3u0jcwe5p7qrc.cloudfront.net/Cybba/Onsite/Template/Prompt/images/close_mobile.png\');\n          background-repeat: no-repeat;\n      }\n  }\n  \n  \n  /* MOBILE TEXT STYLE ENDS */\n  \n  .cybBackgroundOverlay {\n      background-color: grey;\n      height: 100% !important;\n      width: 100% !important;\n      opacity: 0.5;\n      z-index: 100 !important;\n      position: fixed;\n      top: 0;\n  }\n</style>\n\x3c!--DO NOT REMOVE--\x3e\n<meta name="viewport" content="width=device-width, initial-scale=1">\n\x3c!--DO NOT REMOVE--\x3e\n\x3c!--START Background Overlay--\x3e\n<div class="cybBackgroundOverlay"></div>\n\x3c!--END Background Overlay--\x3e\n<div class="vtw-campaign cybPrompt">\n  \x3c!--START X Button--\x3e<a class="vtw-close cybPromptXButton" href="javascript:void(0)"><span onclick="closeOnsiteCYB()"></span></a>\n  \x3c!--END X Button--\x3e\n  <div class="cybPromptBkg">\n    <div class="cybTextcontent">\n      <a href="javascript:void(0);" target="_blank" class="vtw-click  vtw-close">\n        <div onclick="vtCompleteOrder()"><img class="cybHero" src="https://d3u0jcwe5p7qrc.cloudfront.net/03_LATAM/UninterBR/Onsite/487403/487403_UninterBR_Onsite_WP_DS1/images/midscreen.jpg"></div>\n      </a>\n    </div>\n  </div>\n</div>'},templatesPick:{params:{10032192:100},strategy:"weighted-random",ranges:[100]},siteParams:{single:!0,embed:!1,eventBound:!1,displayRules:[{key:"vars.cybAllow",val:"yes",op:"eq"}],displayCount:0,displayCountSession:1,afterClose:"1",autoClose:0,afterSubmit:"close",mailchimpList:0,trigger:{mode:"onClick",params:{selector:""}},testMode:!1,priority:0,displayRulesOR:[],backendRules:[],backendRulesOR:[]},campaignType:7,teasers:{10031117:"\n\n                    ",10032192:"\n\n                    ",10032436:"\n\n                    ",10032683:"\n\n                    "}},1029807:{id:1029807,templates:{
10032436:'<style>\n\n .vtw-close.cybPromptXButton {\n      right: 30px;\n      position: fixed;\n      width: 25px;\n      height: 35px;\n      top: 12px;\n      z-index: 9999999999999;\n      opacity: 0.5;\n      line-height: 200%;\n      background-image: url(\'https://d3u0jcwe5p7qrc.cloudfront.net/Cybba/Onsite/Template/Prompt/images/close-window.png\');\n      background-repeat: no-repeat;\n      background-color: transparent;\n  }\n/* PROMPT CONTENT STYLES START*/\n\t.cybHero{\n\t\twidth: 100%;\n\t}\n  .cybHeading1 {\n      padding-top: 0%;\n      font-size: 20px !important;\n      color: #ffffff !important;\n      font-family: Arial, sans-serif !important;\n      padding-bottom: 0%;\n      font-weight: 700 !important;\n      text-transform: uppercase !important;\n      line-height: 130%;\n  }\n  .cybHeading2 {\n      padding-top: 0%;\n      font-size: 20px !important;\n      color: #ffffff !important;\n      font-family: Arial, sans-serif !important;\n      padding-bottom: 0%;\n      font-weight: 700 !important;\n      text-transform: uppercase !important;\n      line-height: 130%;\n  }\n  .cybPrompt .cybMainCTA {\n      font-family: Arial, sans-serif !important;\n      padding: 9px 14px !important;\n      text-align: center !important;\n      color: #FFF !important;\n      font-weight: normal !important;\n      display: inline-block !important;\n      font-size: 18px !important;\n      width: 30% !important;\n      border-radius: 0px !important;\n      margin-top: 20px;\n      background-color: #043899 !important;\n      text-decoration: none !important;\n  }\n/* PROMPT CONTENT STYLES END*/\n     .cybTextcontent {\n      padding: 0px 20px !important;\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      margin-right: -50%;\n      transform: translate(-50%, -50%);\n      font-family: Arial, sans-serif !important;\n      text-align: left !important;\n  }\n/* BACKGROUND STYLES START*/\n  .cybPromptBkg {\n      height: 100%;\n      overflow: hidden;\n      width: 100%;\n      background-repeat: no-repeat;\n      background-color: transparent;\n      background-position-x: center;\n      background-size: cover;\n      \n  }\n  .cybPrompt {\n      position: fixed;\n      width: 540px;\n      max-width: 735px;\n      height: 375px !important;\n      text-align: center;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      border-radius: 0px !important;\n      z-index: 99999999 !important;\n      display: flex;\n  }\n/* BACKGROUND STYLES END*/\n/* MOBILE TEXT STYLE STARTS */\n  @media (max-width:480px) {\n      .vtw-close img {\n          right: 85% !important;\n      }\n      .cybPromptBkg {\n          position: absolute;\n          bottom: 0;\n          background-size: cover;\n      }\n      .cybHeading1 {\n          font-size: 35px !important;\n          line-height: 150% !important;\n          padding: 5% 0;\n      }\n      .cybHeading2 {\n          font-size: 20px !important;\n      }\n      .cybPrompt {\n          position: fixed;\n          width: 80vw !important;\n          max-width: 735px;\n          text-align: center;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          border-radius: 0px !important;\n          z-index: 99999999 !important;\n          display: flex;\n      }\n      .cybTextcontent {\n          text-align: left !important;\n      }\n      .cybPrompt .cybMainCTA {\n          padding: 9px 14px !important;\n          text-align: center !important;\n          width: 40vw !important;\n          top: 65% !important;\n      }\n      .vtw-close.cybPromptXButton {\n          right: -2px;\n          position: fixed;\n          width: 25px;\n          height: 35px;\n          top: calc(100% - 80%) !important;\n          text-decoration: none !important;\n          background-image: url(\'https://d3u0jcwe5p7qrc.cloudfront.net/Cybba/Onsite/Template/Prompt/images/close_mobile.png\');\n          background-repeat: no-repeat;\n      }\n  }\n  \t/* MOBILE TEXT STYLE ENDS */\n.cybBackgroundOverlay {\n      background-color: grey;\n      height: 100% !important;\n      width: 100% !important;\n      opacity: 0.5;\n      z-index: 100 !important;\n      position: fixed;\n      top: 0;\n  }\n</style>\n\n\x3c!--DO NOT REMOVE--\x3e\n<meta name="viewport" content="width=device-width, initial-scale=1">\n\x3c!--DO NOT REMOVE--\x3e\n\n\x3c!--START Background Overlay--\x3e\n<div class="cybBackgroundOverlay"></div>\n\x3c!--END Background Overlay--\x3e\n\n<div class="vtw-campaign cybPrompt">\n    \n  \x3c!--START X Button--\x3e\n    <a class="vtw-close cybPromptXButton" href="javascript:void(0)"><span onclick="closeOnsiteCYB()"></span></a>\n  \x3c!--END X Button--\x3e\n    \n  <div class="cybPromptBkg">\n      <div class="cybTextcontent">\n\n        <a href="javascript:void(0)" target="_blank" class="vtw-click  vtw-close">\n          <div onclick="vtCompleteOrder()"><img class="cybHero" src="https://d3u0jcwe5p7qrc.cloudfront.net/03_LATAM/UninterBR/Onsite/407/images/407_UninterBR_Prompt.jpg"></div>\n        </a>\n      </div>\n  </div>\n</div>'},templatesPick:{params:{10032436:100},strategy:"weighted-random",ranges:[100]},siteParams:{single:!0,embed:!1,eventBound:!1,displayRules:[{key:"vars.cybAllow",val:"yes",op:"eq"}],displayCount:0,displayCountSession:1,afterClose:"1",autoClose:0,afterSubmit:"close",mailchimpList:0,trigger:{mode:"onClick",params:{selector:""}},testMode:!1,priority:0,displayRulesOR:[],backendRules:[],backendRulesOR:[],endDate:!1,end:!1,startDate:!1,start:!1},campaignType:7,teasers:{10031117:"\n\n                    ",10032192:"\n\n                    ",10032436:"\n\n                    ",10032683:"\n\n                    "}},1030049:{id:1030049,templates:{10032683:'<style>\n\n .vtw-close.cybPromptXButton {\n      right: 30px;\n      position: fixed;\n      width: 25px;\n      height: 35px;\n      top: 12px;\n      z-index: 9999999999999;\n      opacity: 1;\n      line-height: 200%;\n      background-image: url(\'https://d3u0jcwe5p7qrc.cloudfront.net/Cybba/Onsite/Template/Prompt/images/close-window.png\');\n      background-repeat: no-repeat;\n      background-color: transparent;\n  }\n/* PROMPT CONTENT STYLES START*/\n\t.cybHero{\n\t\twidth: 100%;\n\t}\n  .cybHeading1 {\n      padding-top: 0%;\n      font-size: 20px !important;\n      color: #ffffff !important;\n      font-family: Arial, sans-serif !important;\n      padding-bottom: 0%;\n      font-weight: 700 !important;\n      text-transform: uppercase !important;\n      line-height: 130%;\n  }\n  .cybHeading2 {\n      padding-top: 0%;\n      font-size: 20px !important;\n      color: #ffffff !important;\n      font-family: Arial, sans-serif !important;\n      padding-bottom: 0%;\n      font-weight: 700 !important;\n      text-transform: uppercase !important;\n      line-height: 130%;\n  }\n  .cybPrompt .cybMainCTA {\n      font-family: Arial, sans-serif !important;\n      padding: 9px 14px !important;\n      text-align: center !important;\n      color: #FFF !important;\n      font-weight: normal !important;\n      display: inline-block !important;\n      font-size: 18px !important;\n      width: 30% !important;\n      border-radius: 0px !important;\n      margin-top: 20px;\n      background-color: #043899 !important;\n      text-decoration: none !important;\n  }\n/* PROMPT CONTENT STYLES END*/\n     .cybTextcontent {\n      padding: 0px 20px !important;\n      position: absolute;\n      top: 50%;\n      left: 50%;\n      margin-right: -50%;\n      transform: translate(-50%, -50%);\n      font-family: Arial, sans-serif !important;\n      text-align: left !important;\n  }\n/* BACKGROUND STYLES START*/\n  .cybPromptBkg {\n      height: 100%;\n      overflow: hidden;\n      width: 100%;\n      background-repeat: no-repeat;\n      background-color: transparent;\n      background-position-x: center;\n      background-size: cover;\n      \n  }\n  .cybPrompt {\n      position: fixed;\n      width: 540px;\n      max-width: 735px;\n      height: 375px !important;\n      text-align: center;\n      top: 50%;\n      left: 50%;\n      transform: translate(-50%, -50%);\n      border-radius: 0px !important;\n      z-index: 99999999 !important;\n      display: flex;\n  }\n/* BACKGROUND STYLES END*/\n/* MOBILE TEXT STYLE STARTS */\n  @media (max-width:480px) {\n      .vtw-close img {\n          right: 85% !important;\n      }\n      .cybPromptBkg {\n          position: absolute;\n          bottom: 0;\n          background-size: cover;\n      }\n      .cybHeading1 {\n          font-size: 35px !important;\n          line-height: 150% !important;\n          padding: 5% 0;\n      }\n      .cybHeading2 {\n          font-size: 20px !important;\n      }\n      .cybPrompt {\n          position: fixed;\n          width: 80vw !important;\n          max-width: 735px;\n          text-align: center;\n          top: 50%;\n          left: 50%;\n          transform: translate(-50%, -50%);\n          border-radius: 0px !important;\n          z-index: 99999999 !important;\n          display: flex;\n      }\n      .cybTextcontent {\n          text-align: left !important;\n      }\n      .cybPrompt .cybMainCTA {\n          padding: 9px 14px !important;\n          text-align: center !important;\n          width: 40vw !important;\n          top: 65% !important;\n      }\n      .vtw-close.cybPromptXButton {\n          right: -2px;\n          position: fixed;\n          width: 25px;\n          height: 35px;\n          top: calc(100% - 80%) !important;\n          text-decoration: none !important;\n          background-image: url(\'https://d3u0jcwe5p7qrc.cloudfront.net/Cybba/Onsite/Template/Prompt/images/close_mobile.png\');\n          background-repeat: no-repeat;\n      }\n  }\n  \t/* MOBILE TEXT STYLE ENDS */\n.cybBackgroundOverlay {\n      background-color: grey;\n      height: 100% !important;\n      width: 100% !important;\n      opacity: 0.5;\n      z-index: 100 !important;\n      position: fixed;\n      top: 0;\n  }\n</style>\n\n\x3c!--DO NOT REMOVE--\x3e\n<meta name="viewport" content="width=device-width, initial-scale=1">\n\x3c!--DO NOT REMOVE--\x3e\n\n\x3c!--START Background Overlay--\x3e\n<div class="cybBackgroundOverlay"></div>\n\x3c!--END Background Overlay--\x3e\n\n<div class="vtw-campaign cybPrompt">\n    \n  \x3c!--START X Button--\x3e\n    <a class="vtw-close cybPromptXButton" href="javascript:void(0)"><span onclick="closeOnsiteCYB()"></span></a>\n  \x3c!--END X Button--\x3e\n    \n  <div class="cybPromptBkg">\n      <div class="cybTextcontent">\n\n        <a href="javascript:void(0)" class="vtw-click  vtw-close">\n          <div onclick="vtCompleteOrder()"><img class="cybHero" src="https://d3u0jcwe5p7qrc.cloudfront.net/03_LATAM/UninterBR/Onsite/1162/1162_UninterBR_Onsite_Prompt_SG1/images/1162_midscreen.jpg"></div>\n        </a>\n      </div>\n  </div>\n</div>'},templatesPick:{params:{10032683:100},strategy:"weighted-random",ranges:[100]},siteParams:{single:!0,embed:!1,eventBound:!1,displayRules:[{key:"vars.cybAllow",val:"yes",op:"eq"}],displayCount:0,displayCountSession:1,afterClose:"1",autoClose:0,afterSubmit:"close",mailchimpList:0,trigger:{mode:"onClick",params:{selector:""}},testMode:!1,priority:0,displayRulesOR:[],backendRules:[],backendRulesOR:[],endDate:!1,end:!1,startDate:!1,start:!1},campaignType:7,teasers:{10031117:"\n\n                    ",10032192:"\n\n                    ",10032436:"\n\n                    ",10032683:"\n\n                    "}}},content:{campaigns:{}},adserver:{}},object.User={data:{},context:{vars:{pageType:""}},getLocalUser:function(){var e=object.Helpers.readCookie(object.defaults.prefix+object.defaults.cookieNames.uId);if(null!=e){var t=e.split("_");e={userId:t[0],sessionId:"1",email:"true"==t[2],push:"true"==t[3]},object.Helpers.setCookie(object.defaults.cookieNames.uId,e)}else if(e=object.Helpers.getCookie(object.defaults.cookieNames.uId),vtlodash.isObject(e)){var n=e.userId+"_"+e.sessionId+"_"+e.email+"_"+e.push;object.Helpers.writeCookie(object.defaults.prefix+object.defaults.cookieNames.uId,n,object.defaults.expiration)}return!vtlodash.isEmpty(e)&&e||null},requestUser:function(e){if(!0!==object.state.waitUserRequest){object.Helpers.log("Requesting user data from server..."+JSON.stringify(e),"info"),e=e||{};var t={callback:object.defaults.userCallback,shopId:object.shop.id,oldUserId:object.User.data.userId};e.userId&&(t.userId=e.userId),e.uuid&&(t.uuid=e.uuid),e.email&&object.Helpers.emailIsValid(e.email)?(t.email=e.email,vtlodash.isFunction(windowAlias.btoa)&&(t.email=windowAlias.btoa(t.email))):t.email=null;var n=object.Helpers.addQueryString(object.defaults.userHost,t);object.state.botagent||(object.Helpers.getAsync(n),object.state.waitUserRequest=!0)}},isIdentified:function(){return!!object.User.data.email||!!object.Helpers.emailIsValid(object.User.data.email)},changeUserByEmail:function(e){e=object.Helpers.cleanEmail(e),object.Helpers.emailIsValid(e)&&object.User.requestUser({email:e})},changeUserById:function(e){object.User.data.userId!==""+e&&object.User.requestUser({userId:e})},changeUserByUuid:function(e){object.User.data.uuid!==""+e&&object.User.requestUser({uuid:e})},callbackUser:function(e){object.Helpers.log("Callback User server data","info");var t={};if(e.userId&&(t.userId=e.userId),t.sessionId="1",t.email=!!e.email,t.push=!!e.push,e.ts){var n=object.defaults.nowTimeLocal-parseInt(e.ts);n=n>100?n:1,object.Helpers.setCookie(object.defaults.cookieNames.ts,n,object.defaults.dayDuration),object.defaults.nowTime-=n}object.Helpers.setCookie(object.defaults.cookieNames.uId,t),object.User.data=t,object.state.hasUser=!0,object.User.context&&object.User.context.all&&(object.User.context.all.hasEmail=object.User.isIdentified(),object.User.context.all.hasPush=!!object.User.data.push),object.state.loginToPush&&(object.state.eventQueue.push(object.state.loginToPush),delete object.state.loginToPush),object.state.waitUserRequest=!1},activityInit:function(){function e(){var t=Date.now()-object.state.lastActiveTime;t>a&&(object.Campaign.triggerInactivityCampaigns(t/1e3),s+=1),n&&clearInterval(n);var o=a+1e3*s;o<12e4&&(n=windowAlias.setTimeout(e,o))}function t(){object.state.lastActiveTime=Date.now(),s=1,object.shop.params.hasSendActTriggers&&(!object.state.lastCallActive||object.state.lastActiveTime-object.state.lastCallActive>o)&&(object.User.activitySend(s),object.Helpers.log("Sending activity","info"))}if(object.shop.params.hasActTriggers||object.shop.params.hasSendActTriggers){var n,a=5e3,o=12e4;object.state.lastActiveTime=Date.now();var s=0,i=document.documentElement,r=document;!function(){object.Helpers.addEventListener(i,"mousedown",t,!0),object.Helpers.addEventListener(i,"keypress",t,!0),object.Helpers.addEventListener(r,"touchmove",t,!0),object.Helpers.addEventListener(r,"scroll",t,!0),e()}()}},activitySend:function(e){object.Helpers.log("Updating server user activity for check "+e,"info"),object.state.lastCallActive=object.state.lastActiveTime;var t={shopId:object.shop.id,userId:object.User.data.userId,ts:object.state.lastActiveTime},n=object.Helpers.addQueryString(object.defaults.userHost+"/active",t);object.Helpers.getAsync(n)}},object.eventApi={convertEventObject:function(e){var t={type:""};for(var n in e)if(e.hasOwnProperty(n)){t.type=n;var a=vtlodash.isObject(e[n])?e[n]:{};if("confirmation"===n&&vtlodash.size(a)>1)try{t.items=a.items||[],t.generic=a.generic||{},delete a.items,["orderId","total","email"].forEach(function(e,n){a[e]&&(t.generic[e]=a[e])}),a={}}catch(e){object.Helpers.log("Error creating generic for confirmation ","error")}"event"===n&&(t.type="generic",t.generic=e.event,t.generic.event_name&&(t.generic.event_name=object.eventApi.formatEventName(t.generic.event_name)),a={}),"addtocart"!=n&&"viewitem"!=n&&"addtowishlist"!=n||!a.itemId||(a.itemId=(""+a.itemId).trim(),object.setVar("itemId",a.itemId)),"viewcategory"==n&&a.category&&(a.category=(""+a.category).trim().toLowerCase().replace(/\s/g,"_"),object.setVar("category",a.category)),"search"==n&&a.query&&(a.query=(""+a.query.replace(/"/g,"'")).trim(),object.setVar("query",a.query),a.query=a.query.toLowerCase()),"pageview"==n&&a.url&&(a.url=a.url.replace(/"/g,"'")),a.device=object.User.context.session.deviceType,t=vtlodash.merge(t,a),vtlodash.isFunction(windowAlias.btoa)&&t.email&&(t.email=windowAlias.btoa(t.email))}else;return object.state._vtsid&&(t._vtsid=object.state._vtsid),t},formatEventName:function(e){return e.trim().toLowerCase().replace(/\s/g,"_")},sendEventArray:function(e){if(object.Helpers.log("Received array events "+JSON.stringify(e),"info"),vtlodash.isArray(e)&&(ret_array=[],!object.state.botagent)){for(var t=object.Helpers.getCookie(object.defaults.cookieNames.uId),n=0;n<e.length;n++){var a=e[n],o={userId:t.userId};a=object.eventApi.convertEventObject(a),o=vtlodash.merge(o,a),ret_array.push(o)}var s={data:JSON.stringify(ret_array),callback:object.defaults.eventCallback},i=object.defaults.eventHost+object.shop.id+"/"+a.type;i=object.Helpers.addQueryString(i,s),object.Helpers.getAsync(i)}},pushNext:function(e){object.Helpers.setCookie(object.defaults.cookieNames.ne,e)},sendEvent:function(e){try{object.Helpers.log("Received event "+JSON.stringify(e),"info")}catch(e){}if(!object.state.botagent){if(e=object.eventApi.convertEventObject(e),!object.eventApi.validateEvent(e,!0))return object.Helpers.log("Event not valid "+JSON.stringify(e),"error"),!1;var t=object.Helpers.getCookie(object.defaults.cookieNames.uId),n={userId:t.userId};t.userId!=object.User.data.userId&&(n._vtolduser=object.User.data.userId),n=vtlodash.merge(n,e);var a={data:JSON.stringify(n),callback:object.defaults.eventCallback};("update"==e.type&&n.lastVisitDate||"siteclose"==e.type)&&(a._bqstore=0);var o=object.defaults.eventHost+object.shop.id+"/"+e.type;return o=object.Helpers.addQueryString(o,a),object.Helpers.getAsync(o),object.Helpers.sendToAnalytics(n),!0}},callbackEvent:function(e){if(vtlodash.isObject(e))var t=JSON.stringify(e);if(object.Helpers.log("Event received "+t,"info"),e.userId!==object.User.data.userId){object.Helpers.log("New session for user ","info");var n=object.User.data;n.sessionId="1",n.userId=e.userId,vtlodash.isEmpty(n)||object.Helpers.setCookie(object.defaults.cookieNames.uId,n)}},hashEvent:function(e){return btoa(unescape(encodeURIComponent(JSON.stringify(object.Helpers.getSortedDict(e)))))},validateEvent:function(e,t){if("viewitem"==e.type&&!e.itemId)return!1;if("login"==e.type&&!e.email&&!e.uuid&&!e.userId)return!1;if("viewcategory"==e.type&&!e.category)return!1;if("addtocart"==e.type&&!e.itemId)return!1;if("addtowishlist"==e.type&&!e.itemId)return!1;if("search"==e.type&&!e.query)return!1;if("generic"==e.type&&!e.generic.event_name)return!1;if("confirmation"==e.type&&e.generic&&e.generic.orderId){if(object.User.context.all.orderId===e.generic.orderId)return!1;object.Helpers.updateCookie(object.defaults.cookieNames.all,{orderId:e.generic.orderId}),object.User.context.all.orderId=e.generic.orderId}if(t){object.state.guardEvents=object.state.guardEvents||[];var n=object.eventApi.hashEvent(e);if(object.state.guardEvents.indexOf(n)>=0)return!1;object.state.guardEvents.push(n)}return!0}},object.Helpers={getContextValue:function(e,t,n){var a=object.Helpers.getDeepValue(object.User.context,e);if("all.hasEmail"===e&&(a=object.User.isIdentified()),0==e.indexOf("cookie.")&&(a=object.Helpers.readCookie(e.split(".").splice(1).join("."))),0==e.indexOf("jsvar.")&&(a=object.Helpers.getDeepValue(windowAlias,e.split(".").splice(1).join("."))),"e"==t&&n&&"session.vte."+n.type===e)switch(n.type){case"viewitem":case"addtocart":case"addtowishlist":a=n.itemId?n.itemId:"";break;case"search":a=n.query?n.query:"";break;case"viewcategory":a=n.category?n.category:""}return a},getDeepValue:function(e,t){try{if(!t)return;for(var n=t.split("."),a=0;a<n.length;a++)if(void 0===(e=e[n[a]]))return;return e}catch(e){object.Helpers.log("Error extracting deep value","error")}},returnRandomZoneBanners:function(e,t){if(!vtlodash.isArray(e)||t<1)return!1;for(var n,a,o=e.length;0!==o;)a=Math.floor(Math.random()*o),o-=1,n=e[o],e[o]=e[a],e[a]=n;return e=object.Helpers.returnValidZoneBanners(e),e.slice(0,t)},returnValidZoneBanners:function(e){for(var t=[],n=0;n<vtlodash.size(e);){var a=e[n];object.Campaign.checkDisplayLimits(a.tpl,object.shop.adserver.campaigns[a.campaign].siteParams.banners[a.tpl])&&object.shop.adserver.templates[a.tpl]&&t.push(a),n++}return t},cleanEmail:function(e){return e&&e.replace(/[\s\'\"\/\\#]/g,"").toLowerCase()},extractTagFromHtml:function(e,t){if(!e||!t)return"";var n=new RegExp("<"+t+"[^>]*>([\\s\\S]*?)<\\/"+t+">","i");return result=n.exec(e),vtlodash.isArray(result)&&result.length>0?result[1]:""},addClass:function(e,t){e.className=e.className.split(t).join(" ")+" "+t},removeClass:function(e,t){e.className=e.className.split(t).join(" ")},serializeForm:function(e){var t,n,a=[];if("object"==typeof e&&"FORM"==e.nodeName){var o=e.elements.length;for(i=0;i<o;i++)if(t=e.elements[i],t.name&&!t.disabled&&"file"!=t.type&&"reset"!=t.type&&"submit"!=t.type&&"button"!=t.type)if("select-multiple"==t.type)for(n=e.elements[i].options.length,j=0;j<n;j++)t.options[j].selected&&(a[a.length]=t.name+"="+t.options[j].value);else("checkbox"!=t.type&&"radio"!=t.type||t.checked)&&(a[a.length]=t.name+"="+t.value)}return a},serializeObjectForm:function(e){if("object"==typeof e&&"FORM"==e.nodeName&&window.FormData){var t=new FormData(e),n={};return Object.keys(t).forEach(function(e,a){var o=t[e];e=e.replaceAll("[","").replaceAll("]","").replaceAll("form",""),void 0!==n[e]?(Array.isArray(n[e])||(n[e]=[n[e]]),n[e].push(o)):n[e]=o}),n}},pickRandomPercentages:function(e){var t,n,a,o,s;o=100*Math.random(),s=t=0;for(n in e)if(a=e[n],s=t,t+=a,s<=o&&o<=t)return n;throw new Error("Could not pick any number for items "+e)},generateRandomBetween:function(e,t,n){return n?Math.floor(Math.random()*(t-e))+e:Math.random()*(t-e)+e},valuesComparer:function(val1,val2,op){if(val1="false"!==val1&&("true"===val1||val1),!1===(val2="false"!==val2&&("true"===val2||val2))&&vtlodash.isUndefined(val1)&&"eq"==op)return!0;if(0===val2&&vtlodash.isUndefined(val1)&&["eq","lte","gte"].indexOf(op)>=0)return!0;switch(op){case"gt":return val1>val2;case"gte":return val1>=val2;case"lt":return val1<val2;case"lte":return val1<=val2;case"eq":return val1===val2;case"ne":return val1!=val2;case"regex":if(vtlodash.isUndefined(val1))return!1;var r=new RegExp(val2);return!!r.test(val1);case"eval":try{var x=eval(val2.replace(/\(x\)/g,val1))}catch(e){var x=!1}return!!vtlodash.isBoolean(x)&&x}return!1},getSortedDict:function(e){if(!vtlodash.isObject(e))return e;var t={};return Object.keys(e).sort().forEach(function(n){t[n]=object.Helpers.getSortedDict(e[n])}),t},addEventListener:function(e,t,n,a){return a=!vtlodash.isUndefined(a)&&a,e.addEventListener?(e.addEventListener(t,n,a),!0):e.attachEvent?e.attachEvent("on"+t,n):void(e["on"+t]=n)},getAsync:function(e,t){void 0===t&&(e+=(-1==e.indexOf("?")?"?":"&")+"_ts="+String(Math.round(1e8*Math.random())));var n=object.Helpers.embedTag("script","","head",{type:"text/javascript",src:e});try{n.async=!0}catch(e){}return n},vtPostMessage:function(){object.Helpers.addEventListener(windowAlias,"message",function(e){var e=e.data;try{if(e=JSON.parse(e),!e._vt)return;e.setVar&&isArray(e.setVar)?object.setVar(e.setVar[0],e.setVar[1]):e.event&&object.eventApi.sendEvent(e.event)}catch(e){}},!1)},emailIsValid:function(e){return e=object.Helpers.cleanEmail(e),/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)},log:function(e,t){var n=(new Date).getTime()-object.defaults.nowTimeLocal;t=t||"info",e=vtlodash.isObject(e)?JSON.stringify(e):e;var a={info:1,warning:2,error:3,none:4};if(a[object.defaults.debug]<=a[t])try{console.log("["+t+"]["+n+"]"+e)}catch(e){}},setAnalyticsSource:function(e,t){if(object.shop.ganalytics&&!0===object.shop.ganalytics.setSource){var n=setInterval(function(){if("undefined"!=typeof ga){try{object.state.ganame=ga.getAll()[0].get("name")+"."}catch(e){object.state.ganame=""}ga(object.state.ganame+"send","pageview",{campaignSource:"vtmarketing",campaignMedium:t,campaignName:e}),clearInterval(n)}},100);setTimeout(function(){clearInterval(n)},1e3)}},sendToAnalytics:function(e){if(object.shop.ganalytics&&!0===object.shop.ganalytics.status&&!(object.shop.ganalytics.events.length&&object.shop.ganalytics.events.indexOf(e.type)<0)){var t=setInterval(function(){var n="";try{switch(e.type){case"viewitem":case"addtocart":case"addtowishlist":n=e.itemId;break;case"viewcategory":n=e.category;break;case"checkout":n=e.step||"";break;case"sitesubmit":case"siteclick":case"siteclose":case"sitedisplay":n=e.tracking.vt_campaign+"_"+e.tracking.vt_content;break;case"search":n=e.query;break;case"confirmation":n=(e.orderId?e.orderId+"_":"")+(e.items?e.items.length:0)}}catch(e){object.Helpers.log("Error building opt_label for analytics","error")}if("undefined"!=typeof ga){try{object.state.ganame=ga.getAll()[0].get("name")+"."}catch(e){object.state.ganame=""}ga(object.state.ganame+"send","event",object.shop.ganalytics.category,e.type,n,0,{nonInteraction:1}),clearInterval(t)}},100);setTimeout(function(){clearInterval(t)},1e3)}},getStorageType:function(){if(vtstore.enabled)return"vts";if(window.indexedDB=window.indexedDB||window.mozIndexedDB||window.webkitIndexedDB||window.msIndexedDB,window.indexedDB){var e=window.indexedDB.open("vtstore",1);return e.onupgradeneeded=function(t){var n=e.result;object.state.db=n;var a=n.createObjectStore("vtStoreObj",{keyPath:"id"});object.state.store=a},e.onerror=function(e){object.Helpers.log("DB error","error")},e.onsuccess=function(t){object.state.db=e.result},"db"}return!1},updateCookie:function(e,t){var n=object.Helpers.getCookie(e,!0);n&&(vtlodash.isObject(t)?n.val=vtlodash.merge(n.val,t):n.val=t,object.Helpers.setCookie(e,n.val,n.exp))},setCookie:function(e,t,n){if(e=object.defaults.prefix+e,n=vtlodash.isNumber(n)?n:0,"vts"==object.state.storage)vtstore.set(e,{val:t,exp:n,time:(new Date).getTime()});else if("db"==object.state.storage)try{object.state.db.transaction(["vtStoreObj"],"readwrite").objectStore("vtStoreObj").put({id:e,val:t,exp:n,time:(new Date).getTime()}).onsuccess=function(e){}}catch(a){setTimeout(function(){object.Helpers.setCookie(e.replace(object.defaults.prefix,""),t,n)},50)}if(e===object.defaults.prefix+object.defaults.cookieNames.uId){var a=t.userId+"_"+t.sessionId+"_"+t.email+"_"+!!t.push;object.Helpers.writeCookie(object.defaults.prefix+object.defaults.cookieNames.uId,a,object.defaults.expiration)}},getCookie:function(e,t){t=!!t,e=object.defaults.prefix+e;var n=function(n){return t?n:n?n.exp>0&&(new Date).getTime()-n.time>n.exp?(object.Helpers.removeCookie(e),null):n.val:null};if("vts"==object.state.storage){var a=vtstore.get(e);return n(a)}if("db"==object.state.storage)try{object.state.db.transaction(["vtStoreObj"],"readwrite").objectStore("vtStoreObj").get(e).onsuccess=function(e){return n(e.target.result)}}catch(t){setTimeout(function(){return object.Helpers.getCookie(e.replace(object.defaults.prefix,""))},50)}},readCookie:function(e){var t=null;try{t=new RegExp(e+"=([^;]+)").exec(document.cookie)}catch(e){object.Helpers.log("Trying to read inexistent cookie","warning")}return null!=t?unescape(t[1]):null},writeCookie:function(e,t,n){try{if(vtlodash.isNumber(n)){var a=new Date;a.setTime(a.getTime()+n),n=";expires="+a.toGMTString()}else n="";document.cookie=e+"="+t+n+";domain=."+window.location.hostname+";path=/"}catch(e){object.Helpers.log("Error trying to set cookie","warning")}},removeCookie:function(e){if(e=object.defaults.prefix+e,"vts"==object.state.storage)vtstore.remove(e);else if("db"==object.state.storage)try{object.state.db.transaction(["vtStoreObj"],"readwrite").objectStore("vtStoreObj").delete(e)}catch(t){setTimeout(function(){object.Helpers.removeCookie(e.replace(object.defaults.prefix,""))},100)}},extractMainURL:function(e){return e.indexOf("?")>=0?e.substring(0,e.indexOf("?")):e},extractDomain:function(e){var t;return e=e||"",t=e.indexOf("//")>-1?e.split("/")[2]:e.split("/")[0],t=t.split(":")[0]},makeQueryString:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t.join("&")},addQueryString:function(e,t){return object.Helpers.extractMainURL(e)+"?"+object.Helpers.makeQueryString(vtlodash.merge(object.Helpers.getURLParams(e),t))},getURLParams:function(e){return e.substring(e.indexOf("?")+1).replace(/(^\?)/,"").split("&").map(function(e){return e=e.split("="),e[0]&&!vtlodash.isUndefined(e[1])&&(this[e[0]]=e[1]),this}.bind({}))[0]},browserInfo:function(e){var t,n=navigator.userAgent,a=n.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(a[1])){if(t=/\brv[ :]+(\d+)/g.exec(n)||[],"name"==e)return"explorer";if("version"==e)return t[1]}if("Chrome"===a[1]){if(null!=(t=n.match(/\bOPR\/(\d+)/))&&"name"==e)return"opera";if(null!=t&&"version"==e)return t[1]}return a=a[2]?[a[1],a[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(t=n.match(/version\/(\d+)/i))&&a.splice(1,1,t[1]),"version"==e?a[1]:"name"==e?(a[0]="MSIE"==a[0]?"Explorer":a[0],a[0].toLowerCase()):void 0},browserLang:function(){var e=window.navigator.userLanguage||window.navigator.language;return e&&e.substring(0,e.indexOf("-"))||""},osName:function(){for(var e=[{string:navigator.platform.toLowerCase(),subString:"win",identity:"Windows"},{string:navigator.platform.toLowerCase(),subString:"mac",identity:"Mac"},{string:navigator.userAgent.toLowerCase(),subString:"iphone",identity:"iOS"},{string:navigator.userAgent.toLowerCase(),subString:"android",identity:"Android"},{string:navigator.platform.toLowerCase(),subString:"linux",identity:"Linux"}],t=0;t<e.length;t++){var n=e[t].string;if(n&&-1!=n.indexOf(e[t].subString))return e[t].identity}},inputHasValue:function(e,t){var n,a=!1;switch(e.nodeName){case"INPUT":switch(e.type){case"text":case"url":case"email":case"date":case"number":case"hidden":case"password":case"button":case"reset":case"submit":a=e.value;break;case"checkbox":case"radio":a=t.querySelector('input[name="'+e.name+'"]:checked'),a&&(a=a.value)}break;case"TEXTAREA":a=e.value;break;case"SELECT":switch(e.type){case"select-one":a=e.value;break;case"select-multiple":for(n=e.options.length-1;n>=0;n-=1)e.options[n].selected&&(a=e.options[n].value)}break;case"BUTTON":switch(e.type){case"reset":case"submit":case"button":a=e.value}}return vtlodash.isString(a)&&(a=encodeURIComponent(a.trim())),a},isDomNode:function(e){try{return!!e.nodeName}catch(e){return!1}},applyStyle:function(e,t,n){if(e)if(object.Helpers.isDomNode(e))e.style[t]=n;else for(el in e)e.hasOwnProperty(el)&&object.Helpers.isDomNode(e[el])&&(e[el].style[t]=n)},showDom:function(e){object.Helpers.applyStyle(e,"display","block")},hideDom:function(e){object.Helpers.applyStyle(e,"display","none")},embedTag:function(e,t,n,a){n=n||"body",e=e||"div",t=t||"";var o=documentAlias.createElement(e);for(el in a)a.hasOwnProperty(el)&&o.setAttribute(el,a[el]);return o.innerHTML=t,vtlodash.isString(n)?documentAlias.getElementsByTagName(n)[0].appendChild(o):object.Helpers.isDomNode(n)&&n.appendChild(o),o},readDataLayer:function(){if(windowAlias&&vtlodash.isArray(windowAlias.dataLayer)&&vtlodash.size(windowAlias.dataLayer)>0){for(var e=windowAlias.dataLayer,t={event:{}},n=0;n<e.length;n++)if(!vtlodash.isObject(e[n])||e[n].event&&0===e[n].event.indexOf("gtm."))vtlodash.isArguments(e[n])&&"event"==e[n][0]&&(t.event[e[n][1]]=t.event[e[n][1]]||[],t.event[e[n][1]].push(e[n][2]));else if(e[n].event)t.event[e[n].event]=t.event[e[n].event]||[],t.event[e[n].event].push(e[n]);else for(var a in e[n])e[n].hasOwnProperty(a)&&(t[a]=t[a]||[],t[a][e[n][a]]=t[a][e[n][a]]||[],t[a][e[n][a]].push(e[n][a]));return t}return null},deviceType:function(){
var e=object.Helpers.strtolower(navigator.userAgent||navigator.vendor||window.opera),t="desktop";return e.match(/(ipad|galaxy|xoom|touchpad|t800)/)?t="tablet":(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4)))&&(t="mobile"),t},strtolower:function(e){return void 0==e&&(e=""),vtlodash.isString(e)?e.toLowerCase():e},getExternalReferrer:function(){return object.Helpers.extractDomain(documentAlias.referrer)==windowAlias.location.hostname?null:documentAlias.referrer},checkAndSubscribe:function(e,t,n,a){var o=document.querySelector(e);if(o&&object.Helpers.emailIsValid(o.value)){var s=!0;if(t){s=!1;var i=document.querySelector(t);i&&i.checked&&(s=!0)}if(!s)return;var r={login:{email:o.value}},c=!1;return a&&Object.keys(a).forEach(function(e,t){if(0===e.indexOf("_ls_"))return void(c=!0)}),c||(r.login.isSubscribed=!0),a&&vtlodash.isObject(a)&&(r.login=vtlodash.merge(a,r.login)),n?object.eventApi.pushNext(r):object.state.eventQueue.push(r),!0}return!1}},object.Recommender={callBackRecommenderContent:function(data){object.Helpers.log("Start inserting content campaigns into page","info"),object.state.waitReccEvent=!1;for(cId in object.state.contentReccs){var cDom=document.getElementById(object.defaults.idPrefix+cId);if(cDom&&data[cId])if(!0===object.shop.content.campaigns[cId].siteParams.testMode&&"info"===object.defaults.debug||!object.shop.content.campaigns[cId].siteParams.testMode){var newHtml=object.Campaign.interpolateVars(data[cId]);cDom.innerHTML=newHtml,eval(object.Helpers.extractTagFromHtml(newHtml,"script")),object.state.eventQueue.push(object.Campaign.createSiteEvent(object.defaults.siteEvents.display,cId,object.state.contentReccs[cId]))}else object.Helpers.log("Campaign "+cId+" not embeded because of test mode!","error")}object.Helpers.log("Finished inserting content campaigns into page","info")},callBackRecommenderTwo:function(data){object.Helpers.log("Started inserting recommender response one campaign","info");for(var cId in data)if(data.hasOwnProperty(cId)){var cDom=document.getElementById(object.defaults.idPrefix+cId);if(cDom&&data[cId]){if(vtlodash.isString(data[cId]))var newHtml=object.Campaign.interpolateVars(data[cId]);else if(vtlodash.isObject(data[cId])){data[cId].loadLibrary&&eval(data[cId].loadLibrary),data[cId].campaign&&("content"==data[cId].campaign.type?object.shop.content.campaigns[cId]=data[cId].campaign:object.shop.campaigns[cId]=data[cId].campaign);var newHtml=object.Campaign.interpolateVars(data[cId].html)}cDom.innerHTML=newHtml,eval(object.Helpers.extractTagFromHtml(newHtml,"script"))}if(object.state.pageCampaigns[cId]&&!0!==object.state.pageCampaigns[cId])var tpl=object.state.pageCampaigns[cId];else if(cDom&&cDom.getAttribute("data-tpl"))var tpl=cDom.getAttribute("data-tpl");tpl&&object.Campaign.attachClickEvents(cId,tpl,cDom)}object.Helpers.log("Finished inserting recommender response for one campaign","info")},getData:function(e,t){if("content"==t&&(vtlodash.size(object.state.contentReccs)<1||object.state.calledContentReccs))return void object.Helpers.log("No recommendations campaigns on page/already called! ","warning");var n={userId:object.User.data.userId,sessionId:object.User.data.sessionId,campaigns:e};if(object.state.waitReccEvent&&["content"].indexOf(t)>=0){var a={},o="";object.state.reccEvent&&(object.state.reccEvent.hasOwnProperty("viewitem")&&(object.Helpers.log("Recommender event "+JSON.stringify(object.state.reccEvent),"info"),a.itemId=object.state.reccEvent.viewitem.itemId,o="viewitem"),object.state.reccEvent.hasOwnProperty("addtocart")&&(object.Helpers.log("Recommender event "+JSON.stringify(object.state.reccEvent),"info"),a.itemId=object.state.reccEvent.addtocart.itemId,o="addtocart"),object.state.reccEvent.hasOwnProperty("viewcategory")&&(object.Helpers.log("Recommender event "+JSON.stringify(object.state.reccEvent),"info"),a.category=object.state.reccEvent.viewcategory.category,o="viewcategory")),n.eventType=o,n.event=a}var s={data:JSON.stringify(n),callback:object.defaults.reccsCallbackTwo};if("content"==t){var i=vtlodash.size(object.state.contentReccs)+" campaigns";s.callback=object.defaults.reccsCallbackContent,object.state.calledContentReccs=!0}if("preview"==t){var i="preview "+s.data;s.callback=object.defaults.reccsCallbackTwo,s.returnType="detail"}if(0===vtlodash.size(n.campaigns))return void object.Helpers.log("Trying to request recommender without campaigns ","error");var r=object.defaults.reccsHost+object.shop.id+"/";return r=object.Helpers.addQueryString(r,s),object.Helpers.log("Calling the recommender for "+i,"info"),object.Helpers.getAsync(r),n.campaigns}},object.Campaign={extractAttributeFromClass:function(e){var t=new RegExp(object.defaults.siteClasses.attrPrefix+"([^\\s]+)","g");try{t.lastIndex=0;return t.exec(e)[1]}catch(t){object.Helpers.log("Error extracting attribute or from class "+e,"error")}return null},displayCampaign:function(cId,display){if(!cId||!object.shop.campaigns[cId])return!1;var campaign=object.shop.campaigns[cId],ret={};if(4==campaign.campaignType){windowAlias._vtpoll.data=campaign;var div=windowAlias._vtpoll.init(!1);documentAlias.getElementsByTagName("body")[0].appendChild(div),ret.tpl=0,object.Campaign.attachClickEvents(cId,ret.tpl,div)}else{ret.tpl=object.Helpers.pickRandomPercentages(campaign.templatesPick.params);var div=documentAlias.createElement("div");object.Helpers.hideDom(div),div.setAttribute("id",object.defaults.idPrefix+cId),div.setAttribute("data-tpl",ret.tpl);var runJs=!1;if(!1===campaign.templates[ret.tpl]){var param={};param[cId]=ret.tpl,object.Recommender.getData(param,"interaction")}else{var newHtml=object.Campaign.interpolateVars(campaign.templates[ret.tpl]);div.innerHTML=newHtml,runJs=!0}if(documentAlias.getElementsByTagName("body")[0].appendChild(div),runJs&&eval(object.Helpers.extractTagFromHtml(newHtml,"script")),object.Campaign.attachClickEvents(cId,ret.tpl,div),"timeOnPage"!==campaign.siteParams.trigger.mode&&campaign.teasers&&campaign.teasers[ret.tpl]){var div_t=documentAlias.createElement("div");div_t.setAttribute("id",object.defaults.idPrefix+cId+"_teaser"),div_t.setAttribute("data-tpl",ret.tpl),div_t.innerHTML=campaign.teasers[ret.tpl],documentAlias.getElementsByTagName("body")[0].appendChild(div_t),object.Helpers.log("Displaying teaser for "+cId,"info"),object.Campaign.attachTeaserClickEvents(cId,div_t,div)}}return display&&object.Helpers.showDom(div),ret.dom=div,ret},embedCampaign:function(e,t,n){if(!window.vt_stopcampaigns){if(e&&t){var a="body";if(n&&n.vt_selector)var a=documentAlias.querySelector(n.vt_selector);var o=object.Helpers.embedTag("div","",a,{id:object.defaults.idPrefix+e,"data-tpl":t}),s={};return s[e]=t,object.Recommender.getData(s,"preview"),object.state.pageCampaigns[e]||(object.state.pageCampaigns[e]=t),o}var i=object.Helpers.getCookie(object.defaults.cookieNames.cStatus+e);vtlodash.isNull(i)&&(i={no:0}),i.stop&&!object.shop.campaigns[e].siteParams.displayCountSession&&"0"==object.shop.campaigns[e].siteParams.afterClose&&delete i.stop;var r=object.User.context.session[e];vtlodash.isNull(r)&&(r=0);var o=documentAlias.getElementById(object.defaults.idPrefix+e);try{if(object.shop.campaigns[e].siteParams.displayCountSession&&r>=object.shop.campaigns[e].siteParams.displayCountSession&&(object.Helpers.log("Number of displays per session overcome for "+e,"error"),i.stop=!0),!0===object.shop.campaigns[e].siteParams.testMode&&"info"!==object.defaults.debug)return void object.Helpers.log("Campaign "+e+" not embeded because of test mode!","error");if(!object.Campaign.checkDisplayLimits(e,object.shop.campaigns[e].siteParams))return;if(o||!(i.no<object.shop.campaigns[e].siteParams.displayCount)&&object.shop.campaigns[e].siteParams.displayCount||!0===i.stop)return void object.Helpers.log("Not allowed to embed campaign "+e,"warning");object.Helpers.log("Embeding campaign "+e+" into page","info");var c=object.Campaign.displayCampaign(e,!1);return i.tpl=c.tpl,object.Helpers.setCookie(object.defaults.cookieNames.cStatus+e,i),c.dom}catch(t){object.Helpers.log("Error trying to embed campaign "+e+". Does not exists or attr missing.","error")}}},embedContent:function(cDom,cId,siteParams,tId,groupId){var contentId=cId+"_"+groupId,cStatusSession=object.User.context.session[contentId];if(cStatusSession||(cStatusSession=0),cStatusSession+=1,siteParams.displayCountSession&&cStatusSession>siteParams.displayCountSession)return object.Helpers.log("Number of displays per session overcome for "+contentId,"error"),!1;var sessContext=object.User.context&&object.User.context.session||object.Helpers.getCookie(object.defaults.cookieNames.sess);sessContext[contentId]=cStatusSession,object.Helpers.setCookie(object.defaults.cookieNames.sess,sessContext,object.defaults.sessionDuration);try{if(object.Helpers.log("Embeding content "+contentId+" "+tId+" into page","info"),cDom.setAttribute("id",object.defaults.idPrefix+cId),cDom.setAttribute("data-tpl",tId),!1===object.shop.content.templates[tId])object.state.contentReccs[cId]=tId,siteParams.eventBound&&(object.Helpers.log("Wait recc event is true","info"),object.state.waitReccEvent=!0);else{var newHtml=object.Campaign.interpolateVars(object.shop.content.templates[tId]);cDom.innerHTML=newHtml,eval(object.Helpers.extractTagFromHtml(newHtml,"script"))}return object.Campaign.attachClickEvents(cId,tId,cDom),cDom}catch(e){return object.Helpers.log("Error trying to embed campaign "+contentId+". Does not exists or attr missing.","error"),!1}},runDisplayCampaign:function(cId){var campaign=object.shop.campaigns[cId],cStatus=object.Helpers.getCookie(object.defaults.cookieNames.cStatus+cId);cStatus.no+=1,cStatus.no===campaign.siteParams.displayCount&&(cStatus.stop=!0),cStatus&&cStatus.stop&&!object.shop.campaigns[cId].siteParams.displayCountSession&&delete cStatus.stop,object.Helpers.setCookie(object.defaults.cookieNames.cStatus+cId,cStatus);var cStatusSession=vtlodash.isNumber(object.User.context.session[cId])?object.User.context.session[cId]:0;cStatusSession+=1;var sessContext=object.User.context&&object.User.context.session||object.Helpers.getCookie(object.defaults.cookieNames.sess);if(sessContext[cId]=cStatusSession,object.Helpers.setCookie(object.defaults.cookieNames.sess,sessContext,object.defaults.sessionDuration),cStatus&&(object.state.pageCampaigns[cId]=!0,object.state.eventQueue.push(object.Campaign.createSiteEvent(object.defaults.siteEvents.display,cId,cStatus.tpl)),object.Helpers.log("Campaign "+cId+" has been displayed","info")),cDom_t=documentAlias.getElementById(object.defaults.idPrefix+cId+"_teaser"),object.Helpers.hideDom(cDom_t),campaign.siteParams.jsDisplay)try{eval(campaign.siteParams.jsDisplay)}catch(e){}if(campaign.siteParams.autoClose&&campaign.siteParams.autoClose>0){var cDom=cDom||documentAlias.getElementById(object.defaults.idPrefix+cId);setTimeout(function(){object.Helpers.hideDom(cDom)},1e3*campaign.siteParams.autoClose)}},interpolateVars:function(e,t,n){if(!t)var t=object.User.context;var a=e,o=new RegExp(/\*\*\|([^\s]+?)\|\*\*/g);do{var s=o.exec(e);if(s){var i=object.Helpers.getDeepValue(t,s[1]);if(!(i=i||"")&&n)continue;a=a.replace(s[0],i)}}while(s);return a},increaseCountIsValid:function(e,t,n,a){var o=!1;return"p"===e&&"session.pathname"===t?o=!0:"e"==e&&vtlodash.isString(t)&&"session.vte."+a.type===t&&(o=!0),o},statusObserver:function(e,t){if(!object.state.hasUser)return object.Helpers.log("No user, onsite campaigns delayed for "+e,"info"),void setTimeout(function(){object.Campaign.statusObserver(e,t)},1e3);if(object.Helpers.log("Starting Onsite campaigns observer "+e,"info"),"v"!==e&&object.shop.params.countConditions&&vtlodash.size(object.shop.params.countConditions)>0){object.Helpers.log("Increasing counts for display rules conditions","info");var n=object.Helpers.getCookie(object.defaults.cookieNames.condCount);n=n||{};for(var a=0;a<vtlodash.size(object.shop.params.countConditions);a++){cond=object.shop.params.countConditions[a],condKey=object.shop.params.countConditionsKeys[cond.key+cond.op+cond.val];var o=object.Helpers.getContextValue(cond.key,e,t);object.Helpers.valuesComparer(o,cond.val,cond.op)&&object.Campaign.increaseCountIsValid(e,cond.key,o,t)&&(n[condKey]=n[condKey]||0,n[condKey]+=1)}object.Helpers.setCookie(object.defaults.cookieNames.condCount,n)}if(vtlodash.size(object.shop.campaigns)>0){object.state.campaignsOK=[],object.state.campaignsBackendOK=[];for(cId in object.shop.campaigns){var s=object.Helpers.getCookie(object.defaults.cookieNames.cStatus+cId);if(s&&s.stop&&!object.shop.campaigns[cId].siteParams.displayCountSession&&delete s.stop,object.shop.campaigns.hasOwnProperty(cId)&&(s&&!0!==s.stop||vtlodash.isNull(s))){c=object.shop.campaigns[cId];var i=!1;c.siteParams.displayRulesOR&&c.siteParams.displayRulesOR.length>0&&(i=!0);var r=!1;(object.Campaign.checkDisplayRules(c.siteParams.displayRules,!1)||i&&object.Campaign.checkDisplayRules(c.siteParams.displayRulesOR,!0))&&!object.state.pageCampaigns[cId]&&(r=!0),r&&(c.siteParams.backend?object.state.campaignsBackendOK.push(cId):object.state.campaignsOK.push(cId))}}if(object.tasks.addReadyListener(object.Campaign.triggerCampaigns,"trigc"),vtlodash.size(object.state.campaignsBackendOK)){var l={callback:object.defaults.backendCallback,userId:object.User.data.userId,campaigns:object.state.campaignsBackendOK},d=object.Helpers.addQueryString(object.defaults.backendHost+object.shop.id,l);if(object.state.botagent)return;object.Helpers.getAsync(d)}}object.Helpers.log("Ending Onsite campaigns observer "+e,"info")},triggerCampaigns:function(e){if(e||(e=object.state.campaignsOK),vtlodash.size(e)>0){object.Helpers.log("Triggering campaigns that match display rules","info");for(var t=[],n=!1,a=0;a<vtlodash.size(e);a++)cId=e[a],object.shop.campaigns[cId]&&(object.shop.campaigns[cId].siteParams.priority?vtlodash.isNumber(object.shop.campaigns[cId].siteParams.priority)&&(n&&object.shop.campaigns[cId].siteParams.priority>object.shop.campaigns[n].siteParams.priority||!n)&&(n=cId):t.push(cId));object.Helpers.log("No priority campaigns in "+t.length+". Max priority "+n,"info"),n&&(object.Campaign.triggerOne(n,object.shop.campaigns[n]),t.indexOf(n)>=0&&t.splice(t.indexOf(n),1));for(var a=0;a<t.length;a++)object.Campaign.triggerOne(t[a],object.shop.campaigns[t[a]])}},triggerOne:function(e,t){if(e){!t&&object.shop.campaigns[e]&&(t=object.shop.campaigns[e]),object.Helpers.log("Campaign "+e+" ready to be triggered","info");var n={};n.timeOnPage=function(t,n){object.Helpers.log("Trigger "+e+" after "+n.delay+" seconds","info");var a=vtlodash.isNumber(n.delay)&&1e3*n.delay||0;setTimeout(function(){(!object.shop.campaigns[e].siteParams.single||object.shop.campaigns[e].siteParams.single&&!object.state.singleFlag)&&(object.Helpers.showDom(t),object.Campaign.runDisplayCampaign(e),object.shop.campaigns[e].siteParams.single&&(object.state.singleFlag=!0))},a)},n.onClose=function(t,n){object.Helpers.log("Trigger "+e+" on page unload ","info"),windowAlias.onbeforeunload=function(){return object.Helpers.showDom(t),object.Campaign.runDisplayCampaign(e),"?"}},n.onInactivity=function(t,n){object.state.inactivityCampaigns.push(e)},n.onExit=function(t,n){function a(){object.Helpers.addEventListener(p,"mouseleave",o),object.Helpers.addEventListener(p,"mouseenter",s),object.Helpers.addEventListener(p,"keydown",i)}function o(e){if(!(e.clientY>d.sensitivity)){var t=Math.max(document.documentElement.clientWidth,window.innerWidth||0),n=t*d.cornerWidth/100;"input"!=e.target.tagName.toLowerCase()&&("left"==d.corner&&e.clientX>n||"right"==d.corner&&e.clientX<t-n||"any"==d.corner&&e.clientX>n&&e.clientX<t-n||e.clientX>=t-50||(l=setTimeout(r,1e3*d.delay)))}}function s(){l&&d.cancelDelay&&(clearTimeout(l),l=null)}function i(e){m||e.metaKey&&76===e.keyCode&&(m=!0,l=setTimeout(r,d.delay))}function r(){object.Helpers.showDom(t),object.shop.campaigns[e].siteParams.single&&object.state.singleFlag?object.Helpers.hideDom(t):(object.Campaign.runDisplayCampaign(e),object.shop.campaigns[e].siteParams.single&&(object.state.singleFlag=!0)),c()}function c(e){p.removeEventListener("mouseleave",o),p.removeEventListener("mouseenter",s),p.removeEventListener("keydown",i),l&&clearTimeout(l)}var l,d={sensitivity:n.sensitivity||20,timer:n.timer||1,delay:n.delay||0,cancelDelay:n.cancelDelay||!1,corner:n.corner||"any",cornerWidth:n.cornerWidth||50},p=document.documentElement,m=!1;"os"==d.corner&&(d.corner="left",["Windows"].indexOf(object.User.context.session.osname)>=0&&(d.corner="right")),setTimeout(a,1e3*d.timer),object.Helpers.log("Trigger "+e+" on exit intent","info")},n.onClick=function(t,n){if(n.selector){var a=documentAlias.querySelectorAll(n.selector);for(el in a)a.hasOwnProperty(el)&&object.Helpers.addEventListener(a[el],"click",function(n){n.preventDefault(),object.Helpers.showDom(t),object.state.pageCampaigns[e]||(!object.shop.campaigns[e].siteParams.single||object.shop.campaigns[e].siteParams.single&&!object.state.singleFlag)&&(object.Campaign.runDisplayCampaign(e),object.shop.campaigns[e].siteParams.single&&(object.state.singleFlag=!0))},!1);object.Helpers.log("Trigger "+e+" on click elements "+n.selector,"info")}},n.onScroll=function(t,n){n.percent=vtlodash.isNumber(n.percent)?n.percent:25;var a=function(t,n){try{var a=100*((document.documentElement.scrollTop+document.body.scrollTop)/(document.documentElement.scrollHeight-document.documentElement.clientHeight)||0)}catch(e){var a=0}a>=n&&!object.state.pageCampaigns[e]&&(!object.shop.campaigns[e].siteParams.single||object.shop.campaigns[e].siteParams.single&&!object.state.singleFlag)&&(object.Helpers.showDom(t),object.Campaign.runDisplayCampaign(e),object.shop.campaigns[e].siteParams.single&&(object.state.singleFlag=!0))};object.Helpers.addEventListener(windowAlias,"scroll",function(e){a(t,n.percent)}),object.Helpers.log("Trigger "+e+" on % scroll ","info")},n.onLeave=function(t,n){if(object.state.leaveCp=object.state.leaveCp||[],object.state.leaveCp.push(e),1==object.state.leaveCp.length&&history.replaceState){var a=!1;if(object.Helpers.getExternalReferrer()?(object.state.exit_vtp=history.length-1,_vtsdk.User.context.session.exit_vtp=object.state.exit_vtp,object.Helpers.updateCookie(object.defaults.cookieNames.sess,{exit_vtp:object.state.exit_vtp}),a=!0):history.state&&history.state.vtp&&object.User.context.session.exit_vtp===history.state.vtp&&(object.state.exit_vtp=object.User.context.session.exit_vtp,a=!0),!a)return;object.Helpers.log("onLeave trigger is valid.","info"),history.replaceState({vtp:object.state.exit_vtp,href:location.href},""),history.pushState({vtp:object.state.exit_vtp+1,href:location.href},""),object.Helpers.addEventListener(windowAlias,"popstate",function(t){if(history.state&&history.state.vtp==object.state.exit_vtp)for(var n=0;n<object.state.leaveCp.length;n++){var a=object.state.leaveCp[n],a=documentAlias.getElementById(object.defaults.idPrefix+e);object.Helpers.showDom(a),object.Campaign.runDisplayCampaign(e)}})}},setTimeout(function(){if(["complete","loaded","interactive"].indexOf(document.readyState)>=0){var a=object.Campaign.embedCampaign(e),o=vtlodash.isNull(t.siteParams.trigger.params)?null:t.siteParams.trigger.params;if(a)return object.Helpers.log("Attaching trigger to campaign "+e,"info"),n[t.siteParams.trigger.mode](a,o)}},10)}},triggerInactivityCampaigns:function(e){if(e+=2,object.state.inactivityCampaigns&&object.shop.params.hasActTriggers)for(var t,n=object.state.inactivityCampaigns.length-1;n>=0;n--){var a=object.state.inactivityCampaigns[n];!object.state.pageCampaigns[a]&&object.shop.campaigns[a].siteParams.trigger.params.delay<=e&&(object.Helpers.log("Valid inactivity campaign "+a,"info"),(!object.shop.campaigns[a].siteParams.single||object.shop.campaigns[a].siteParams.single&&!object.state.singleFlag)&&(t=documentAlias.getElementById(object.defaults.idPrefix+a),object.Helpers.showDom(t),object.Campaign.runDisplayCampaign(a),object.shop.campaigns[a].siteParams.single&&(object.state.singleFlag=!0)))}},buildAttrObject:function(e,t){for(var n,a,o={},s=0;s<e.length;s++)try{if(!(n=object.Campaign.extractAttributeFromClass(e[s].className))||!t&&-1!=e[s].className.indexOf(object.defaults.siteClasses.submit))continue;null!==(a=e[s]=e[s].value||null)&&""!==a&&(["radio","checkbox"].indexOf(e[s].type)<0||!0===e[s].checked)&&("tags"==n?(o[n]=o[n]||[],o[n].push(a)):o[n]=a)}catch(e){object.Helpers.log("Error getting attribute type and value from campaign inputs","error")}return o},createSiteEvent:function(e,t,n,a){var o={};if(e){if(a)var a=JSON.parse(JSON.stringify(a));var s=object.shop.campaigns[t]?object.shop.campaigns[t].campaignType:null;if(vtlodash.isNull(s)&&(s=null,vtlodash.isNull(s)&&(s=null==s&&object.shop.params.hasRunningContent&&object.shop.content.campaigns[t]?object.shop.content.campaigns[t].campaignType:null),vtlodash.isNull(s)&&(s=null==s&&object.shop.params.hasRunningAds&&object.shop.adserver&&object.shop.adserver.campaigns&&object.shop.adserver.campaigns[t]?object.shop.adserver.campaigns[t].campaignType:null)),a&&a.campaignType&&(s=a.campaignType),null===s&&(s=0),!t||!n)return!1;o[e]={tracking:{vt_campaign:t,vt_content:n,campaignType:s}},a&&a.generic&&a.generic.tags&&(a.tags=a.generic.tags,delete a.generic.tags),vtlodash.isObject(a)&&(o[e]=vtlodash.merge(o[e],a))}return o},attachTeaserClickEvents:function(e,t,n){object.Helpers.addEventListener(t,"click",function(a){if(a.preventDefault(),[a.target.className,a.target.parentElement.className].indexOf(object.defaults.siteClasses.close)>=0)return void object.Helpers.hideDom(t);object.Helpers.showDom(n),object.Campaign.runDisplayCampaign(e)},!1)},attachClickEvents:function(cId,tpl,cDom){var cDomDom=cDom;if(cDomDom&&cDomDom.innerHTML&&""===cDomDom.innerHTML.trim())return void object.Helpers.log("Empty tag, so we won't attach click events","error");object.Helpers.log("Attaching click events on campaign classes ","info");var elem,toggle_fct=function(e,t,n){try{var n=n||documentAlias.getElementById(object.defaults.idPrefix+e);if(!n)return;var a,o;a=n.getElementsByClassName(t);for(o in a)a.hasOwnProperty(o)&&(a[o].style.display="none"==a[o].style.display?"block":"none")}catch(e){console.log(e)}};elem=cDom.querySelectorAll("[vtw-toggle]");for(el in elem)elem.hasOwnProperty(el)&&object.Helpers.addEventListener(elem[el],"click",function(e){return e.preventDefault(),object.Helpers.log("Toggle event attached to "+el+" element for "+cId,"info"),toggle_fct(cId,elem[el].getAttribute("vtw-toggle"),cDomDom)},!1);var close_fct=function(cId,tpl,cDom){var cDom=cDom||documentAlias.getElementById(object.defaults.idPrefix+cId),cObject=object.shop.campaigns[cId]||object.shop.content.campaigns[cId]||!1;if(cDom&&(object.Helpers.hideDom(cDom),cObject)){if("0"!=cObject.siteParams.afterClose&&(cStatus=object.Helpers.getCookie(object.defaults.cookieNames.cStatus+cId),cStatus.stop=!0,object.Helpers.setCookie(object.defaults.cookieNames.cStatus+cId,cStatus,object.defaults.dayDuration*parseInt(cObject.siteParams.afterClose)),object.Helpers.log("Campaign "+cId+" not displayed for "+cObject.siteParams.afterClose+"days !","info")),cObject.siteParams.jsClose)try{eval(cObject.siteParams.jsClose)}catch(e){}cDom&&cDom.className.indexOf(object.defaults.siteClasses.click)>=0?(object.state.eventQueue.push(object.Campaign.createSiteEvent(object.defaults.siteEvents.click,cId,tpl)),object.Helpers.setAnalyticsSource(cId,"interaction")):object.state.eventQueue.push(object.Campaign.createSiteEvent(object.defaults.siteEvents.close,cId,tpl))}};elem=cDom.getElementsByClassName(object.defaults.siteClasses.close);for(el in elem)elem.hasOwnProperty(el)&&object.Helpers.addEventListener(elem[el],"click",function(e){e.preventDefault(),e.stopPropagation();try{if(e.currentTarget.className.indexOf(object.defaults.siteClasses.overlay)>=0&&e.target!==e.currentTarget)return!1}catch(e){}return object.Helpers.log("Close event attached to "+el+" element for "+cId,"info"),close_fct(cId,tpl,cDomDom)},!1);var click_fct=function(e,t,n){if(object.shop.campaigns[e]||object.shop.content.campaigns[e]||!1){object.state.eventQueue.push(object.Campaign.createSiteEvent(object.defaults.siteEvents.click,e,t)),object.Helpers.setAnalyticsSource(e,"interaction");var a=n.getAttribute("href");a&&("_blank"==n.getAttribute("target")?window.open(a):window.location=a)}};elem=cDom.getElementsByClassName(object.defaults.siteClasses.click);for(el in elem)elem.hasOwnProperty(el)&&object.Helpers.addEventListener(elem[el],"click",function(e){return e.preventDefault(),e.stopPropagation(),object.Helpers.log("Click event attached to "+el+" element for "+cId,"info"),click_fct(cId,tpl,e.currentTarget)},!1);var submit_fct=function(target,cId,tpl,cDom){var cDom=cDom||documentAlias.getElementById(object.defaults.idPrefix+cId),cObject=object.shop.campaigns[cId]||object.shop.content.campaigns[cId]||!1;if(cDom){for(var reqOK=!0,invalidOK=!0,req=cDom.querySelectorAll("[required]"),class2Add="",i=0;i<req.length;i++){class2Add="",object.Helpers.inputHasValue(req[i],cDom)||(reqOK=!1,class2Add=" "+object.defaults.siteClasses.required);try{req[i].className=req[i].className.split(object.defaults.siteClasses.required).join("")+class2Add,req[i].parentNode&&(req[i].parentNode.className=req[i].parentNode.className.split(object.defaults.siteClasses.required).join("")+class2Add)}catch(e){}try{class2Add="",req[i].validity.valid||(class2Add=" "+object.defaults.siteClasses.invalid,req[i].className=req[i].className.split(object.defaults.siteClasses.invalid).join("")+class2Add,invalidOK=!1),req[i].parentNode&&(req[i].parentNode.className=req[i].parentNode.className.split(object.defaults.siteClasses.invalid).join("")+class2Add)}catch(e){}}if(!reqOK)return cDom.className=cDom.className.split(object.defaults.siteClasses.required).join("")+" "+object.defaults.siteClasses.required,void object.Helpers.showDom(cDom.getElementsByClassName(object.defaults.siteClasses.error));if(!invalidOK)return cDom.className=cDom.className.split(object.defaults.siteClasses.invalid).join("")+" "+object.defaults.siteClasses.invalid,void object.Helpers.showDom(cDom.getElementsByClassName(object.defaults.siteClasses.error));var elem=cDom.getElementsByClassName(object.defaults.siteClasses.attr),params=object.Campaign.buildAttrObject(elem,!1),submit_attr=object.Campaign.extractAttributeFromClass(target.className);if(submit_attr&&target.value&&(params[submit_attr]=target.value),submitOK=!1,params.email&&object.Helpers.emailIsValid(params.email)){params.email=object.Helpers.cleanEmail(params.email);var hasList=!1;Object.keys(params).forEach(function(e,t){if(0===e.indexOf("_ls_"))return void(hasList=!0)}),hasList||(params.isSubscribed=!0),params.generic={campaign:cId,content:tpl},object.state.eventQueue&&object.state.eventQueue.push({login:params}),submitOK=!0,object.Helpers.setAnalyticsSource(cId,"interaction"),delete params.generic}else if(params.email&&!object.Helpers.emailIsValid(params.email))return object.Helpers.showDom(cDom.getElementsByClassName(object.defaults.siteClasses.error)),void(cDom.className=cDom.className.split(object.defaults.siteClasses.invalid).join("")+" "+object.defaults.siteClasses.invalid);if(!params.hasOwnProperty("email")||submitOK){object.state.eventQueue&&object.state.eventQueue.push(object.Campaign.createSiteEvent(object.defaults.siteEvents.submit,cId,tpl,{generic:params})),object.Helpers.setAnalyticsSource(cId,"interaction");var next=target.getAttribute("nextstate"),current=target.getAttribute("currentstate");if(next&&current&&(next=0===next.indexOf(object.defaults.siteClasses.classPrefix)?next:object.defaults.siteClasses.classPrefix+next,current=0===current.indexOf(object.defaults.siteClasses.classPrefix)?current:object.defaults.siteClasses.classPrefix+current,object.Helpers.showDom(cDom.getElementsByClassName(next)),object.Helpers.hideDom(cDom.getElementsByClassName(current))),object.Helpers.hideDom(cDom.getElementsByClassName(object.defaults.siteClasses.error)),cObject&&cObject.siteParams.afterSubmit)if("close"===cObject.siteParams.afterSubmit)setTimeout(function(){object.Helpers.hideDom(cDom)},2e3);else if(parseInt(cObject.siteParams.afterSubmit)>0){var cStatus=object.Helpers.getCookie(object.defaults.cookieNames.cStatus+cId);vtlodash.isNull(cStatus)&&(cStatus={no:1}),cStatus.stop=!0,object.Helpers.setCookie(object.defaults.cookieNames.cStatus+cId,cStatus,object.defaults.dayDuration*parseInt(cObject.siteParams.afterSubmit)),object.Helpers.log("Campaign "+cId+" not displayed for "+cObject.siteParams.afterSubmit+"days !","info")}}try{object.state.ganame=object.state.ganame||ga.getAll()[0].get("name")+".",ga(object.state.ganame+"send","pageview","/submit?vt_campaign="+cId+"&vt_content="+tpl)}catch(e){}var onsubmit=target.getAttribute("onsubmit");if(onsubmit)try{eval(onsubmit)}catch(e){}if(cObject){if(cObject.siteParams.jsSubmit)try{eval(cObject.siteParams.jsSubmit)}catch(e){}if(cObject.siteParams.callEndpoint){var url=object.Campaign.interpolateVars(cObject.siteParams.callEndpoint,params,!0);url=object.Campaign.interpolateVars(url,object.shop,!0),url=object.Campaign.interpolateVars(url),object.Helpers.getAsync(url)}}}};elem=cDom.getElementsByClassName(object.defaults.siteClasses.submit);for(el in elem)elem.hasOwnProperty(el)&&object.Helpers.addEventListener(elem[el],"click",function(e){return e.preventDefault(),e.stopPropagation(),object.Helpers.log("Submit event attached to "+el+" element for "+cId,"info"),submit_fct(e.currentTarget,cId,tpl,cDomDom)},!1)},checkDisplayRules:function(e,t){var n=vtlodash.size(e),a=!0;t&&(a=!1);var o,s,i,r;r=object.Helpers.getCookie(object.defaults.cookieNames.condCount);for(var c=0;c<n;c++){var o=e[c];s=object.Helpers.getContextValue(o.key);var i=object.Helpers.valuesComparer(s,o.val,o.op);try{contextCountVal=r[object.shop.params.countConditionsKeys[o.key+o.op+o.val]]}catch(e){contextCountVal=null}if(i&&o.hasOwnProperty("count")&&null!=contextCountVal&&(i=object.Helpers.valuesComparer(contextCountVal,o.count.val,o.count.op)),!t&&!i)return!1;if(t&&i)return!0}return a},checkDisplayLimits:function(e,t){if(!vtlodash.isObject(t))return!1
;var n=object.Helpers.getCookie(object.defaults.cookieNames.capping+e);return n&&(t.dulimit&&n.dulimit>=t.dulimit||t.dlimit&&n.dlimit>=t.dlimit||t.mlimit&&n.mlimit>=t.mlimit)?(object.Helpers.log("Capping exceeded for "+e,"warning"),!1):!(t.start&&t.startDate>object.defaults.nowTime||t.end&&t.endDate<object.defaults.nowTime)||(object.Helpers.log("Time limits exceeded for "+e,"warning"),!1)},embedContentCampaigns:function(){if(!1!==object.shop.params.hasRunningContent&&!0!==object.state.calledContent){object.state.contentReccs=object.state.contentReccs||{},object.state.waitReccEvent=!1,object.Helpers.log("Started content campaigns!","info");var e={};for(cId in object.shop.content.campaigns)if(object.shop.content.campaigns.hasOwnProperty(cId)&&object.Campaign.checkDisplayLimits(cId,object.shop.content.campaigns[cId].siteParams)){var t=object.shop.content.campaigns[cId];if(t.siteParams.selector){var n=documentAlias.querySelector(t.siteParams.selector),a=null;if(object.Helpers.isDomNode(n)){var a=documentAlias.createElement("div");switch(t.siteParams.embedType){case"append":n.appendChild(a);break;case"prepend":n.insertBefore(a,n.firstChild);break;case"after":n.parentNode.insertBefore(a,n.nextSibling);break;case"before":n.parentNode.insertBefore(a,n);break;default:n.innerHTML="",n.appendChild(a)}}}else{var a=documentAlias.createElement("div");documentAlias.body.appendChild(a)}if(object.Helpers.isDomNode(a)&&(!t.siteParams.testMode||!0===t.siteParams.testMode&&"info"===object.defaults.debug)){object.Helpers.log("Embeding content on "+t.siteParams.selector+" in page for campaign "+cId,"info");for(var o=vtlodash.size(t.content),s=0;s<o;s++){var i=object.Helpers.pickRandomPercentages(t.content[s].templatesPick),r=t.content[s].displayRulesOR&&t.content[s].displayRulesOR.length>0;if((!0===object.Campaign.checkDisplayRules(t.content[s].displayRules,!1)||r&&object.Campaign.checkDisplayRules(t.content[s].displayRulesOR,r))&&object.Campaign.embedContent(a,t.id,t.siteParams[t.content[s].id],i,t.content[s].id)){object.Helpers.log("Group "+s+" embeded for campaign "+cId,"info"),e[cId]=t.content[s].id,object.state.eventQueue.push(object.Campaign.createSiteEvent(object.defaults.siteEvents.display,t.id,i));break}}}else object.Helpers.log("Campaign "+cId+" not embeded. Test mode or no element!","error")}return object.state.calledContent=!0,(object.state.waitReccEvent&&vtlodash.isObject(object.state.reccEvent)||!1===object.state.waitReccEvent)&&(object.Helpers.log("Recc Event is already here!","warning"),object.Recommender.getData(object.state.contentReccs,"content")),e}}},object.queueManager={eventsObserver:function(){if(!object.state.hasUser)return void object.Helpers.log("No local user, exiting!","error");if(object.state.waitUserRequest)return void object.Helpers.log("Requesting user!","error");var e=object.state.eventQueue.shift();if(e){if(object.defaults.stopevents)return void object.Helpers.log("Events are stopped!","error");object.state.pageQueue.push(e);var t=object.eventApi.convertEventObject(e);return(e.viewitem||e.viewcategory||e.addtocart)&&object.eventApi.validateEvent(t)&&(object.Helpers.log("Store possible recc event!","info"),object.state.reccEvent=e),e.login&&object.eventApi.validateEvent(t)&&object.state.loginHash!=object.eventApi.hashEvent(t)?(e.login.email?(e.login.email=object.Helpers.cleanEmail(e.login.email),object.User.changeUserByEmail(e.login.email)):e.login.uuid&&object.User.changeUserByUuid(e.login.uuid),object.state.loginToPush=e,void(object.state.loginHash=object.eventApi.hashEvent(t))):vtlodash.isArray(e)?void("setVar"===e[0]&&(object.setVar(e[1],e[2]),object.Campaign.statusObserver("v"))):(vtlodash.size(object.state.contentReccs)>=1&&object.state.waitReccEvent&&object.state.reccEvent&&object.Recommender.getData(object.state.contentReccs,"content"),object.eventApi.sendEvent(e)&&object.tasks.createVisitorContext("e",e),object.Campaign.statusObserver("e",t),e)}}},object.tasks={runShopJS:function(){if(object.shop.params.customJS&&!object.state.runCustomJS){object.state.runCustomJS=!0;try{eval(object.shop.params.customJS)}catch(e){object.Helpers.log("Error running custom JS for shop "+e.message,"error")}}},followDataLayer:function(){var e=object.Helpers.readDataLayer();e&&(object.User.context.vars=object.User.context.vars||{},object.User.context.vars.dataLayer=e)},requestWebID:function(e){if(e=e||object.shop.params.webidTags.join(","),object.shop.params.getVisitorWebid&&windowAlias._vtwebid&&e){var t=object.Helpers.getCookie(object.defaults.cookieNames.webid);if(!t&&e){var n=windowAlias._vtwebid.return_tags_url(object.shop.id,e,"");vtlodash.request(n,function(e){vtlodash.isString(e)&&(e=JSON.parse(e)),vtlodash.isObject(e)&&(object.Helpers.setCookie(object.defaults.cookieNames.webid,e,object.defaults.shortDuration),object.User.context.webid=e)})}else vtlodash.isObject(t)&&(object.User.context.webid=t)}},checkUserIdentity:function(){object.Helpers.log("Checking user identity from URL params","info");for(var e=object.defaults.userIndentityParams.length-1;e>=0;e--){var t,n=object.defaults.userIndentityParams[e];if(object.User.context.session.urlparams.hasOwnProperty(n))return t=object.User.context.session.urlparams[n],"vt_user"==n&&t.length==object.defaults.userKeyLength?object.User.changeUserById(t):object.Helpers.emailIsValid(t)&&object.User.changeUserByEmail(t),!0}return!1},createUserContext:function(e){object.Helpers.log("Creating User context","info");var t=object.User.getLocalUser();t?(object.User.data=t,object.state.hasUser=!0):e||object.User.requestUser()},createVisitorContext:function(trigger,vtevent){object.Helpers.log("Creating visitor context for "+trigger,"info");var allContext=object.User.context&&object.User.context.all||object.Helpers.getCookie(object.defaults.cookieNames.all),sessContext=object.User.context&&object.User.context.session||object.Helpers.getCookie(object.defaults.cookieNames.sess),allChanged=sessChanged=!1;if(vtevent=vtevent||null,trigger=trigger||"p",null==allContext&&(allContext={noVisits:0,firstVisit:object.defaults.nowTime,lastVisit:object.defaults.nowTime},allChanged=!0),"p"==trigger){var urlparams=object.Helpers.getURLParams(windowAlias.location.search),currentUTM={utm_source:null,utm_term:null,utm_campaign:null,utm_content:null,utm_medium:null};if(null!=sessContext&&(currentUTM=vtlodash.overwrite(currentUTM,sessContext)),currentUTM=vtlodash.overwrite(currentUTM,urlparams),null==sessContext&&(sessContext={pathname:"",landing:windowAlias.location.pathname,noPageViews:0,firstVisit:object.defaults.nowTime,city:"",country:""},sessChanged=!0,allContext.noVisits+=1,allContext.lastVisit=sessContext.firstVisit,allChanged=!0,object.state.eventQueue.push({update:{lastVisitDate:object.defaults.nowTime}}),object.shop.params.sessionJS&&!object.state.runSessionJS)){object.state.runSessionJS=!0,vtlodash.isArray(object.shop.params.sessionJS)||(object.shop.params.sessionJS=[object.shop.params.sessionJS]);for(var i=0;i<object.shop.params.sessionJS.length;i++)try{eval(object.shop.params.sessionJS[i])}catch(e){object.Helpers.log("Error running sessionJS "+i+": "+e.message,"error")}}var newReferrer=object.Helpers.getExternalReferrer();if((newReferrer||urlparams.utm_campaign)&&(sessContext.lastReferrer=newReferrer,newReferrer!=allContext.lastReferrer&&(allContext.lastReferrer=newReferrer,allChanged=!0),object.shop.params.referer)){var params={domain:object.Helpers.extractDomain(newReferrer),url:newReferrer};newReferrer&&(params.generic={url:newReferrer}),params=vtlodash.merge(params,currentUTM),object.state.eventQueue.push({referer:params})}for(var i in currentUTM)currentUTM.hasOwnProperty(i)&&delete urlparams[i];sessContext.urlparams=urlparams,sessContext=vtlodash.merge(sessContext,currentUTM),sessContext.timeOnSite=Math.round((object.defaults.nowTime-sessContext.firstVisit)/1e3/60);var current={pathname:windowAlias.location.pathname+windowAlias.location.search+windowAlias.location.hash,homepage:"/"==windowAlias.location.pathname,hostname:windowAlias.location.hostname,urlparams:urlparams,osname:object.Helpers.osName(),browser:object.Helpers.browserInfo("name"),browserVersion:object.Helpers.browserInfo("version"),lang:object.Helpers.browserLang(),deviceType:object.Helpers.deviceType(),vt_campaign:urlparams.vt_campaign||null,vt_content:urlparams.vt_content||null,noPageViews:sessContext.noPageViews+=1};if(urlparams.vt_campaign&&urlparams.vt_content&&(current.vt_click=urlparams.vt_campaign+"_"+urlparams.vt_content),object.shop.push&&object.shop.push.enabled)if(current.pushValid=!0,"chrome"==current.browser){current.pushValid=!0;var fs=window.RequestFileSystem||window.webkitRequestFileSystem;fs&&fs(window.TEMPORARY,100,function(){object.User.context.session.private=!1},function(){object.User.context.session.private=!0,object.User.context.session.pushValid=!1})}else if("firefox"==current.browser){current.pushValid=!0;var db=indexedDB.open("test");db.onerror=function(){object.User.context.session.private=!0,object.User.context.session.pushValid=!1},db.onsuccess=function(){object.User.context.session.private=!1}}sessContext=vtlodash.merge(sessContext,current),object.shop.push&&object.shop.push.enabled&&object.webpush&&!object.state.webpush&&(object.state.webpush=!0),object.shop.params.pageJS&&!object.state.runPageJS&&(object.state.runPageJS=!0,eval(object.shop.params.pageJS))}else if("e"==trigger){var current={};switch(vtevent=object.eventApi.convertEventObject(vtevent),sessChanged=!0,sessContext.vte=sessContext.vte||{},sessContext.vte[vtevent.type]=sessContext.vte[vtevent.type]?sessContext.vte[vtevent.type]+1:1,vtevent.type){case"viewitem":object.setVar("pageType","product");break;case"viewcategory":object.setVar("pageType","category");break;case"confirmation":object.setVar("pageType","confirmation"),allContext.isCustomer=!0,allChanged=!0,allContext.lastPurchaseDays=object.defaults.nowTime,allContext.firstPurchaseDays=allContext.firstPurchaseDays?allContext.firstPurchaseDays:object.defaults.nowTime;break;case"addtocart":sessContext.lastaddcart=object.defaults.nowTime;break;case"search":object.setVar("pageType","search");break;case"addtowishlist":break;case"checkout":object.setVar("pageType","checkout")}}return allChanged&&object.Helpers.setCookie(object.defaults.cookieNames.all,allContext),sessChanged&&object.Helpers.setCookie(object.defaults.cookieNames.sess,sessContext,object.defaults.sessionDuration),sessContext.lastaddcartSec=sessContext.lastaddcart?Math.round((object.defaults.nowTime-sessContext.lastaddcart)/1e3):null,allContext.lastPurchaseDays=allContext.lastPurchaseDays?Math.round((object.defaults.nowTime-allContext.lastPurchaseDays)/object.defaults.dayDuration):null,allContext.firstPurchaseDays=allContext.firstPurchaseDays?Math.round((object.defaults.nowTime-allContext.firstPurchaseDays)/object.defaults.dayDuration):null,allContext.lastVisitDays=allContext.lastVisitDays?Math.round((object.defaults.nowTime-allContext.lastVisitDays)/object.defaults.dayDuration):null,allContext.firstVisitDays=allContext.firstVisitDays?Math.round((object.defaults.nowTime-allContext.firstVisitDays)/object.defaults.dayDuration):null,object.User.context.session=sessContext,object.User.context.all=allContext,object.User.context.all.hasEmail=object.User.isIdentified(),object.User.context.all.hasPush=!!object.User.data.push,object.Helpers.log("Done creating visitor context for "+trigger,"info"),!0},domIsUpdated:function(){object.Helpers.log("Document changed, adding input listeners again","info"),object.Helpers.addEventListener("document","change",object.Helpers.inputEmailListening)},sendClickEvents:function(){object.Helpers.log("Start generate click events","info");var e,t,n=object.User.context.session.urlparams.vt_campaign,a=object.User.context.session.urlparams.vt_content;if(n&&a&&object.shop.content.campaigns[n]||object.shop.campaigns[n]&&object.shop.campaigns[n].templatesPick.params[a]||object.shop.params.hasRunningAds&&object.shop.adserver.campaigns[n]&&object.shop.adserver.templates[a])return t={},(e=object.User.context.session.urlparams.vt_product)&&(t={itemId:e}),object.state.eventQueue.push(object.Campaign.createSiteEvent(object.defaults.siteEvents.click,n,a,t)),void object.Helpers.log("Generate click for onsite: "+n+":"+a,"info")},getVisitorInfo:function(){if(!1!==object.shop.params.getVisitorInfo){var e=object.Helpers.getCookie(object.defaults.cookieNames.visitor);e?vtlodash.isObject(e)&&(object.User.context.session=vtlodash.merge(object.User.context.session,e)):vtlodash.request(object.defaults.visitorHost,function(e){if(vtlodash.isString(e)&&(e=JSON.parse(e)),vtlodash.isObject(e)){var t={city:e.city,state:e.regionName,country:e.country,country_code:e.countryCode,org:e.org};object.Helpers.setCookie(object.defaults.cookieNames.visitor,t,object.defaults.monthDuration),object.User.context.session=vtlodash.merge(object.User.context.session,t)}})}},callbackNull:function(e){object.Helpers.log("Callback without an active role","info")},callbackVisitor:function(e){vtlodash.isObject(e)&&(object.Helpers.setCookie(object.defaults.cookieNames.visitor,e,object.defaults.dayDuration),object.User.context.session=vtlodash.merge(object.User.context.session,e))},injectCss:function(e){object.shop.params.embedCSS&&(object.Helpers.embedTag("link","","head",{href:e,type:"text/css",rel:"stylesheet"}),object.Helpers.log("Injecting proprietary CSS into page","info"))},inputEmailListening:function(){if(!1!==object.shop.params.emailGrab){object.Helpers.log("Adding blur event listeners for every input field.","info");var e=object.shop.params.listenFields||"input[type=text],input[type=email],input[type=input]",t=document.querySelectorAll(e),n=function(e){var t={login:{email:object.Helpers.cleanEmail(e.target.value)}};object.shop.params.grabSource&&(t.login.source=object.shop.params.grabSource);try{var n="";n=e.target.form.id,n&&(t.login.generic={form:n,input:e.target.id||""})}catch(e){}-1===e.target.className.indexOf(object.defaults.siteClasses.attr)&&object.Helpers.emailIsValid(e.target.value)&&object.state.eventQueue.push(t)};for(i in t)t.hasOwnProperty(i)&&object.Helpers.addEventListener(t[i],"blur",n,!1)}},addReadyListener:function(e,t){if(object.Helpers.log("Run ready for "+t,"info"),"complete"===documentAlias.readyState)return object.Helpers.log("Run loadHandler 0"+t,"info"),void e();var n;documentAlias.addEventListener?(object.Helpers.addEventListener(documentAlias,"DOMContentLoaded",function n(){object.Helpers.log("Run loadHandler 1"+t,"info"),e(),documentAlias.removeEventListener("DOMContentLoaded",n,!1)}),object.Helpers.log("Added ready for "+t,"info")):documentAlias.attachEvent&&(documentAlias.attachEvent("onreadystatechange",function n(){"interactive"!==documentAlias.readyState&&"loaded"!==documentAlias.readyState||(e(),documentAlias.detachEvent("onreadystatechange",n),object.Helpers.log("Run loadHandler 2"+t,"info"))}),documentAlias.documentElement.doScroll&&windowAlias===windowAlias.top&&function n(){if(!object.state.hasLoaded){try{documentAlias.documentElement.doScroll("left")}catch(e){return void setTimeout(n,0)}object.Helpers.log("Run loadHandler 3"+t,"info"),e()}}()),new RegExp("WebKit").test(navigator.userAgent)?n=setInterval(function(){(object.state.hasLoaded||/loaded|complete/.test(documentAlias.readyState))&&(object.Helpers.log("Run loadHandler 4"+t,"info"),clearInterval(n),e())},10):(object.Helpers.log("Added load event listener at the end"+t,"info"),object.Helpers.addEventListener(windowAlias,"load",e,!1))}},object.setVar=function(e,t,n){if(0!==n&&1!==n&&2!==n&&(n=0),/^[\s\/a-zA-Z0-9:.\-_;#$!@^&*=<>\\,|{}?]+$/.test(t))return"VTuser"===e?(t&&t.indexOf("@")<0&&atob(t)&&(t=atob(t)),void(object.User.isIdentified()||object.User.changeUserByEmail(t))):"VTsid"===e?void(object.state._vtsid=t):void(object.User.context.vars[e]=t)},object.init=function(){if(!object.state.ready){object.state.ready=!0,object.state.storage=object.Helpers.getStorageType();try{var e=object.Helpers.getCookie(object.defaults.cookieNames.ts);e&&(object.state.timeDiff=e,object.defaults.nowTime=object.defaults.nowTimeLocal-e)}catch(e){console.log(e)}object.state.botagent=!1;try{object.state.botagent=/bot|googlebot|crawler|spider|robot|crawling/i.test(navigator.userAgent)}catch(e){object.Helpers.log("Error checking for bot agents!","error")}windowAlias.location.hostname.indexOf(object.shop.domain);try{if("undefined"!=typeof Prototype&&parseFloat(Prototype.Version.substr(0,3))<1.7&&void 0!==Array.prototype.toJSON){var t=JSON.stringify;JSON.stringify=function(e){var n=Array.prototype.toJSON;delete Array.prototype.toJSON;var a=t(e);return Array.prototype.toJSON=n,a}}}catch(e){}var n=object.Helpers.getCookie(object.defaults.cookieNames.debug);if(object.defaults.debug=object.shop.debug?object.shop.debug:object.defaults.debug,n&&(object.defaults.debug=n),object.Helpers.getCookie(object.defaults.cookieNames.stopevents)&&(object.defaults.stopevents=1),object.state.pageQueue=[],object.state.eventQueue=windowAlias._vteq||[],windowAlias.location.search.indexOf("vt_preview=")>=0){var a=object.Helpers.getURLParams(windowAlias.location.search);return object.defaults.debug="info",object.tasks.createUserContext(),object.tasks.createVisitorContext("p"),void object.Campaign.embedCampaign(a.vt_campaign,a.vt_content,{vt_selector:window.atob(a.vt_selector)})}object.state.eventQueueId=setInterval(object.queueManager.eventsObserver,object.defaults.queueCheckInterval),object.tasks.createUserContext(!0),object.tasks.createVisitorContext("p"),object.state.webpush&&object.tasks.addReadyListener(object.webpush.instantiate,"wpins"),object.Campaign.statusObserver("p"),object.tasks.addReadyListener(object.Campaign.embedContentCampaigns,"emcon"),object.Helpers.vtPostMessage(),object.User.context.session.urlparams.vt_debug&&(object.Helpers.setCookie(object.defaults.cookieNames.debug,object.User.context.session.urlparams.vt_debug),object.defaults.debug=object.User.context.session.urlparams.vt_debug),1==object.User.context.session.urlparams.vt_stopevents?(object.Helpers.setCookie(object.defaults.cookieNames.stopevents,1),object.defaults.stopevents=1):0==object.User.context.session.urlparams.vt_stopevents&&object.Helpers.removeCookie(object.defaults.cookieNames.stopevents),object.tasks.checkUserIdentity(),object.tasks.createUserContext();var o=function(){object.state.hasLoaded||(object.state.hasLoaded=!0,object.Helpers.log("Running onLoad functions","info"),object.tasks.inputEmailListening(),object.tasks.injectCss(object.defaults.stylesheet),object.tasks.runShopJS())};object.tasks.addReadyListener(o,"loadh"),object.tasks.getVisitorInfo(),object.setVar("random",object.Helpers.generateRandomBetween(0,100,!0)),object.tasks.sendClickEvents(),object.tasks.followDataLayer(),object.state.timeDiff||object.User.requestUser({userId:object.User.data.userId}),object.User.activityInit(),object.Helpers.getCookie(object.defaults.cookieNames.ne)&&(object.state.eventQueue.push(object.Helpers.getCookie(object.defaults.cookieNames.ne)),object.Helpers.removeCookie(object.defaults.cookieNames.ne)),object.tasks.requestWebID(),object.Helpers.writeCookie(object.defaults.prefix+object.defaults.cookieNames.shop,object.shop.id)}},object}()),window._vteq=window._vteq||[],checkInit(),_vtshop={};
